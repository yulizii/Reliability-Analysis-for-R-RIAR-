<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24005089" />

<meta name="date" content="2024-12-08" />

<title>Homework-Compilation</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework-Compilation</h1>
<h4 class="author">SA24005089</h4>
<h4 class="date">2024-12-08</h4>



<div id="homework-compilation" class="section level1">
<h1>Homework Compilation</h1>
<p>This vignette compiles the content of ten assignments.</p>
<div id="assignment-1" class="section level2">
<h2>Assignment 1</h2>
<div id="example1" class="section level3">
<h3>Example1</h3>
<p>画一个100个随机点形成的散点图</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">10</span><span class="sc">*</span><span class="dv">20</span>),<span class="at">nrow=</span><span class="dv">100</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">plot</span>(s,<span class="at">main=</span><span class="st">&quot;Hundred points&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example2" class="section level3">
<h3>Example2</h3>
<p>在0到100的范围中选取10个数，绘制每个数的条形图</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">barplot</span>(s,<span class="at">main=</span><span class="st">&#39;outcome&#39;</span>,<span class="at">ylab=</span><span class="st">&#39;value&#39;</span>,<span class="at">xlab=</span><span class="st">&#39;number&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAllBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkJBmkLZmkNtmtrZmtttmtv+QOgCQZjqQkGaQttuQ2/+2ZgC2Zjq2ZpC227a229u22/+2//++vr7bkDrbkGbbtmbbtpDb////tmb/25D/27b//7b//9v///+CvMt7AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAGxklEQVR4nO3dC1fiRgCG4WhVrHULu93uqm2hF226Cwj5/3+uM5MEJCR8iUlgmLzvOeuCxhGeE5JwG6KEDhad+gL4HkAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQyEug9V8vp74Im3wEev10CdChZhFAWd9/iaIffp0nOcpqEo3NSZM99+3O/PRhd0GzxM33u+jiIflvFF1N7c/Wf0bRxYd5TxfxpEBx5LqelwLN0p+OdxY0S6Td5YzZd656WulOCbQc2ascO4M3QNnpRRT9PH+d2NNvFrQc4+SbEXnY/uazXWLcz4U8JVC2rZmlq0sRKP0a3/+zs6BZIl2PzFenkv6Kweppu3VCoPWTu3GZ63Yx3QfKf1pY0G6D0i1RkgKZL2kX014u5QmB0mvpbkuPGVB6S8mBbkoW3ANaRMEClaxBu0B116DHPi+lL9sgp2RXh8I2aPHTH8Vt0C5Qvnr1lS97Mff19Sk7nWF9mJuVx6wgu3uxXSDDZg6KXieb9a3jfDkO2mxrx47mzXHQTVI4DioAZcdBPW2CfDiS/uJOLj9F0f3fbi9mD42vnrMj6S+7C+4DJa+/Gdz7554uoo/3xbwKIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEk6gYo2lQ4u/3eudbxpc+A/n0bQHvDASSGA0gMB5AYDiAxHEBiOIDEcACJ4QASwwEkhgNIDAeQGA4gMRxAYrgi0Dk//HEcoDNeo4IE6nKFDROowz8HkBqr0dL2Tcj5pCIHhhssUJzPILKomkpk2EDrpw1LXPEu9WEDrSabSSAWFTeyYQOxBqnifB4RtkEV5RNkVc6TMXSgmsMBtDdK4bn5wQLN0hnXqqdaGTiQ87md7uzwy4YbKtBqYuczcvM9sZsvy6432bFQuwPFvh9AO91NzKw9cQdrUNs1SvmeDGg1uXxxq9Ciait9JCDx6yfczS+284odGG7AQPWGA0gM5xtQm33Cm8XdDLKzdpPqegrU4s9tFzcbXrNvcsc67y9gILt3sjvvuNW0wwED2aNAC1R1CNhkuCCB8jVo1mpO1ICBsm1Q3G7y4ZCB0ocLW84ZGzRQFwFUa7gggTYfWMFerOQabWu3lx8AUPaI4XsbABAHimXX6E3c1Si7RttWE25iJdcoqfGscoPhggTqJoAqRmn21PPwgArDhQe0OYzmSLr8GnUWQLWGOzZQ8VmLfoDym9kZ3sSanm9+jWyz63l8kyxHZ/iI4lGA7PM9C/usxhk+Jn0koMdk+eOL+/f+Agayz2qsPk4BKr1GNns3fjbmJlZ6jVyzG7snO8dHFI8E1EUA1RouSKCWj5TtDBckkPvUztafxRkyUJK9AtGDh1ybvor1mNug9ZMH98Xa3lsPfw3yEci9odmTbZCXQLX2Yh29LfwsgerU1dvCQwXq7E29oQJ19rbwUIFYg1RdvS08WKCu3hYeLlDN4ZoCqadt9v7K2QG1fG6+6RXyFyg2BG4zVPUyq4EDxeauSHrEDVBZ6W5+/XTgPUHDBsoPFO1zsACVtDlQnN0AVFrOUv3s0MCBNofSlY87Dh2o5nAAieEAEsMBJIYDSAzXNVDT1yAOD6jj8wABBBBAAAEEEEAAAQSQX0A9vT4oGKC+Xh8UClBvr+4IBaj69UHFp54Lj080O1/8/e7P9wVUYw0Kr4bbIPX6oPBqtsJ1M8HHWdXxcVB4ASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCARQCKARACJABIBJAJIBJDoTICWo0e9UC8BJAJI5A/QavJ1Yj9ayU0EZr4sR/b8eDmy31yOPpv/3axO9gOYzInVx99bfvR7vXwCupjaj1faAtnzFiG+fHFnlqNx+gFM9sRqcpxZnnwCGrub0hbInU+/6f63Um4pO8dceqL/fAJKYbZAj9m2xwHZbdDiYrpwHyacOx6hcwG6dS6300U21x9AB9egZGdSx17zEWi8NdkCuW3Q9XzjMlwg+wl466eoCGTWnIWdxtHuxZJZtrM7Qv4Buckav+7dxD6P8s+fjNxsxMMD8jSARACJABIBJAJIBJAIIBFAIoBEAIkAEgEkAkgEkAggEUAigEQAiQASASQCSASQCCDR/4XNt2fqvEbaAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="example3" class="section level3">
<h3>Example3</h3>
<p>计算1000次每次100步的非负随机游走(计1步为0.1格)，计算到达每一步的频数</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>nub<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="dv">101</span>,<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">size=</span><span class="dv">100</span>,<span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">sum</span>(s)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>nub[s1]<span class="ot">&lt;-</span>nub[s1]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>}</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">t</span>(nub),<span class="at">main=</span><span class="st">&#39;Random Walk&#39;</span>,<span class="at">xlab=</span><span class="st">&quot;step number&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;frequency&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="assignment-2" class="section level2">
<h2>Assignment 2</h2>
<div id="exercise-3.4" class="section level3">
<h3>Exercise 3.4</h3>
<p>Caption: use <span class="math inline">\(\frac{e^{-\frac{x}{\sigma}}}{\sigma}\)</span> as
<span class="math inline">\(g(x)\)</span>, where <span class="math inline">\(c=2.5\)</span>, <span class="math inline">\(G(x)=1-e^{-\frac{x}{\sigma}}\)</span>.By using
inverse sampling method:<span class="math inline">\(G^{-1}(x)=-\sigma\ln(1-x)\)</span>, random number
of <span class="math inline">\(G(x)\)</span> can be generated.</p>
<p><span class="math inline">\(\sigma=1\)</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e5</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">1</span>;</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  }</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>}</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">&quot;Rayleigh distribution at sigma=1&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">freq=</span>F,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="fu">curve</span>((x<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\sigma=0.5\)</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e5</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="fl">0.5</span>;</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>  }</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>}</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">&quot;Rayleigh distribution at sigma=0.5&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="at">freq=</span>F,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="fu">curve</span>((x<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><span class="math inline">\(\sigma=2\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e5</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">2</span>;</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>    y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  }</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>}</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">hist</span>(y,<span class="at">breaks=</span><span class="dv">20</span>,<span class="at">main=</span><span class="st">&quot;Rayleigh distribution at sigma=2&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="at">freq=</span>F,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">curve</span>((x<span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span><span class="sc">/</span>sig<span class="sc">^</span><span class="dv">2</span>)),<span class="dv">0</span>,<span class="dv">10</span>,<span class="at">xlab=</span><span class="st">&quot;&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xaxt=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.11" class="section level3">
<h3>Exercise 3.11</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span>;p1<span class="ot">&lt;-</span><span class="fl">0.25</span>;j<span class="ot">&lt;-</span><span class="dv">0</span>;x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="cf">while</span>(j<span class="sc">&lt;</span>n){</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  <span class="cf">if</span>(u<span class="sc">&lt;</span>p1){</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    x[j]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  }</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    x[j]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  }</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>}</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq=</span>F,<span class="at">main=</span><span class="st">&quot;p1=0.25&quot;</span>,<span class="at">breaks=</span><span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAGACAMAAAA6QU9cAAAAk1BMVEUAAAAAADoAAGYAOmYAOpAAZrY6AAA6ADo6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmZmZmkLZmtttmtv+QOgCQZgCQZjqQttuQ2/+2ZgC2Zjq227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb2//b/9vb////tmb/25D/27b//7b//9v///9+BJY9AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKWElEQVR4nO3da2ObNhgFYDlN3N3qrtvqdWFbt5m2W3Bt//9fN4TwHXSQdXvB53xyEhDmiRACyUbtGGtU7jcgPQQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAhEHFChHl8ufrX9XanZz8fffn2nlPr2o35ZqiZP8d6PMCBtcQm0XZ4jVPPm59nzTnPeF9CXH9U1UKlmv+0+KfXe/Fh7PTzv1nO93Gah3kR+S9mBCvXwR33IvNJHTH3AzJod1/uv2npSgzw1LG012bybP5n1/tGLvY/8/gQAqcMRU6pXfy4vgdpactk2NUCVUt/sm6NIkQD08HH3uWlHPv3wsr0Cql8aoBrkGHOIFUfcWJEA9H533P8W6CSdQHW1qlfbfpjXh+aX+fWJL1wEADU7XrbVYBjQ18VpW17GrEJSgKr2LDXoENN/PWGs7gHoogZZG+kLn8kDdbVB56f5+jfH03zT/hif9bt5R/sdNhKADmexXVcbpCvXL6ajaP5YHOpP/XPdh/w8n3RPet8PaitBB9DxUqP546FymY6i6uh7h4wAoIe/Pyj1fdvZ6wCqL9Dm5mK1+WN7fWpI9XXr7IeIPiKA4jUgAUIgEAKBEAgkO5D0EAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAnEDaid7CZ9vEDROQOX+oyNV9M+QiIkL0HZ5YCljTgsUFRegzeLw0Zrqbg4y1iAQxzaorUJsg3qiJ7nHnpgsLKPuB+n/VfRtxN5AzKjVSiJQFfcjfg6RB1Qo9Wb93cvpCT9nxAEV+rM2Te2RcZqXBtTUm/VrDSSjoygPSPd+tv/uWIN6Uu7rjaE6KeWQYG9sSMQB7Upz+qp6v+/g3oFSF4e2RiCwNblAZc9ZjEBpi0NbIxDYGoHA1sQBwVGNOwfCoxr3DTTgnnQioLbPLg1owKhGCiCtY2SkAQmpQZpFJtCAUY07B8KjGgmBjkda3K2JLq57GwZodahIcbcmurjubRAIbOMCKO6NuikArWJWpNEDNU01gc62cQbUvoq3NdHFdW+DQGAbBALbIBDYBoHANghkKb+9AiNQX/nnLAS6Kp9AoHwCgfJHCpRs+stYgWIVd10+gUD5BALlEwiUTyBQPoFA+QQC5fcBRethTAUoWiUiENqi6OKuyycQKJ9AoHwCgfIJBMonECifQKB84UDZ50kLB8o/T1o2kIBZrrKBBMyTlg3EGoSSeZ70fjaZXKDM86Q7WWQBpS7uonACgcLlA+lnnDbNUJYP9coH0t8rsFno5wYTqCvmNL9d1k00gbqy7ygWjy8SgeIMbNzUUSyeJALFqURubVDLUneHzoHSTH/JC1TvNH5q+74rvV3eYw3S53Df74+cNNAugNHUgQzRgO8nu9NGumo6yk1HJ0RxoZMZSF+pGxmPr7ibMNBmEeLrNacM9Nb4WKtP3lENGUB9zW/zt7yjGjmBimNfuP80n/uetIwaZEnuUY38p3mQrDXo8EExwUBZRzUsLAmANos3+wELaz8646hGXiCpxZ2WTCBQcnYg/RXIpe8TIaYMVDy+rOdPuwLfNhtUXOhkB9KdHP090X5fxj5xoKLGsV1qOBQXPNmB6mNrs3h8MeOCAYoLnUFAEYYNzu4HzZ63Sy+f3ECr8LVoWqd5AuUECvKAxykDFSEetjJhoMtniXgWFzwCgEI88GnCQL4n+Ivigic7kOV5NANKiT+7IzvQoBtmw4sLnuxAIos7LZlAoOT8QPVB9vhS+J3spwxUzZ5LfTUvdH5QdiA96FVaJvg6Fhc82YF0R1EDjfqOYooaVHjdtY8D1Pv9mxnaoNKju7iLBoRZEp3FvB9SPGkggcXtSyWQrUj7BzETnsWssxJciwuXYSzRgYr2g3Kec+0nC1TtG+f1XNpZTATQyd0ycWPzIoBOrsCslxo5pgELAYLTM3WyTAMeEVCeSZwjAsozDXhEQOOoQYFHDvZAx3EJaxuUehrwoNnRV6+CvgOnpaNOA+7637uwSACKWlzXrhHodN2LBsTpNtm9AJ3unSsLgcQDDTjX3TdQ/xcu3Fbc5brjB8JzZO4dqG+OTJDpL5MAilJcC9vu5IGZQIeVVqsToMMFJ4EOK00QKOiXm0wRKGhxXUCuo2Fnr0Le8RAL5M5y9irvHgUubn/umgBQnFGN650cK1CkUY0YQMHaIZdSotyT7rypetON1g7mAHG7mg88qnH7LTGZQMFrUBSWjEDBRzUmBxR6VGN6QIGLIxBamkBgaQKBpQkEliYQWJpAtkV97vjcBVAkFgIRiEBmUQKBRQkEFiUQWJRAYFEC2ZYLc9fZ/irIfftAzK7TXyKynL0KsGv+RdxSHIHQcgQCyxEILEcgsByBLMvEHU+dAFB0FgIRKNQr/870xIH8K1FqoPi36scOlIiFQAS6R6Akd4FGDZSOJROQ5zzpLEC+n2JzWdh3nnQWoJVfLUo6y3XqQN7zpLMBeRxlyWpQypscXa8c9nPgHnXEZ550HpbEQD7zpO8DyKM4AnUW1/ZC0l/DZwJy7iiq9hySiyUxkHtHMTfL8dWtZ/rIp/ncLGevbuCJ21EU0PKcvbqpFkWrQTJanqtXzkZhOooX01+U6EQEwh3F6SVwP2h6IRDIjUB+D7gZU1iDQAgEQiCQwBerlg3JiPv7dlkYX6z6bAiPyibYhtcaAy41fDY0fqCBz064dUPjB2INQsGjGj4bmgCQz8XqfQB5hEDeGyKQ7xLTBhprCARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCCQVUDNgZLkNWSm1fx73Tes3Kew38tZzpZyfZJ0IaLusd7/sf3v6aeWVRQitbwqx3+ms6r9uFq5CiYDMU9p7pzyY4QDLg8rB+k02CyuQ2YbzrIukbVBvHRmy/7b1m5SPv9qA1q9tK/cmKVDRJ2DePBxs612/LcPaBlUPfy1wM3aVlED9g0WmatgrCBhs0keQFajUMwrgMwivkhCosrfREMiy/s4MZdqBZoNq6WXSAdn+/0MOMftgZVOCHagp3bR2DokPVJoOTGnbvwGNtHV9sxWd/t03/M5NdaoaVFre+oDTPFi/jbUGmakXUg+x9dx++kAdRbS+ib0nrVupk/kXA5MIqD0C+glK+6UGXL8JuNSoBlytXIUXqyAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBDpQHrW2WbhPGklXKQD6RlP7l81EzDSgfT05rc3zQAPFPFAu8L9AyghIx+oGjJ9M17EA22XP2X91k/xQOXjf84zU0NGOpCe3ez+jXIBIx2oaCY3Z2ympQNlD4FACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAvkfZoXWvpMMFosAAAAASUVORK5CYII=" /><!-- --></p>
<p>当p1=0.5时会出现双峰</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span>;p1<span class="ot">&lt;-</span><span class="fl">0.5</span>;j<span class="ot">&lt;-</span><span class="dv">0</span>;x<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="cf">while</span>(j<span class="sc">&lt;</span>n){</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="cf">if</span>(u<span class="sc">&lt;</span>p1){</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    x[j]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  }</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>    x[j]<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  }</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>}</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">freq=</span>F,<span class="at">main=</span><span class="st">&quot;p1=0.5&quot;</span>,<span class="at">breaks=</span><span class="dv">50</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="exercise-3.20" class="section level3">
<h3>Exercise 3.20</h3>
<p>考虑到泊松分布<span class="math inline">\(E(N(t))=\lambda
t\)</span>,则在<span class="math inline">\(t=10\)</span>时有<span class="math inline">\(E[N(10)-N(0)]=10\lambda\)</span></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fl">1e4</span>; r <span class="ot">&lt;-</span> <span class="dv">4</span>; beta <span class="ot">&lt;-</span> <span class="dv">3</span>;j<span class="ot">&lt;-</span><span class="dv">0</span>;y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n);</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="cf">while</span>(j<span class="sc">&lt;</span>n){</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="co">#lambda &lt;- rgamma(1, r, beta)#假设lambda依然由gamma分布给出</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="dv">10</span><span class="sc">*</span>lambda); </span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="co">#y1 &lt;- sum(rnbinom(x1,size=r,prob=beta/(1+beta)));</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    y1<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">rgamma</span>(x1,r,beta))</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    y[j]<span class="ot">&lt;-</span>y1;</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    j<span class="ot">=</span>j<span class="sc">+</span><span class="dv">1</span>;</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>   </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>}</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>   ave<span class="ot">=</span><span class="fu">mean</span>(y)</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>   avar<span class="ot">=</span><span class="fu">var</span>(y)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>   tave<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">*</span><span class="dv">4</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>   tvar<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">*</span><span class="dv">4</span><span class="sc">/</span><span class="dv">3</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>    <span class="fu">hist</span>(y,<span class="at">main=</span><span class="st">&quot;Compound Possion Gamma Process at t=10&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;X&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Count&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>根据直方图可以得出<span class="math inline">\(E=26.65\)</span>,<span class="math inline">\(var=8.63\)</span>。理论计算显示<span class="math inline">\(E=26.67\)</span>,<span class="math inline">\(var=8.89\)</span>，相差不大！</p>
</div>
</div>
<div id="assignment-3" class="section level2">
<h2>Assignment 3</h2>
<div id="exercise-5.4" class="section level3">
<h3>Exercise 5.4</h3>
<p>注意到Beta(3,3)函数的pdf可以表示为:<span class="math inline">\(Beta(3,3)=\frac{x^2(1-x)^2}{B(3,3)}\)</span>,得到其cdf可以表示为:<span class="math inline">\(\int_{0}^{x}\frac{x^2(1-x)^2}{B(3,3)}=B(3,3)E(xY^2(1-Y)^2),Y\sim
U(0,x)\)</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e4</span>;j<span class="ot">&lt;-</span><span class="dv">1</span>;mcbeta<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">9</span>);fc<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">9</span>);</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.1</span>, <span class="at">to=</span><span class="fl">0.9</span>, <span class="at">length.out=</span><span class="dv">9</span>)){</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">runif</span>(m,<span class="at">min=</span><span class="dv">0</span>,<span class="at">max=</span>x)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  theta.hat<span class="ot">&lt;-</span><span class="fu">mean</span>(y<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  mcbeta[j]<span class="ot">&lt;-</span>theta.hat<span class="sc">*</span>x<span class="sc">*</span><span class="fu">gamma</span>(<span class="dv">6</span>)<span class="sc">/</span><span class="fu">gamma</span>(<span class="dv">3</span>)<span class="sc">/</span><span class="fu">gamma</span>(<span class="dv">3</span>)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  fc[j]<span class="ot">&lt;-</span>(<span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)<span class="sc">-</span>mcbeta[j])<span class="sc">/</span><span class="fu">pbeta</span>(x,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  j<span class="ot">&lt;-</span>j<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.1</span>, <span class="at">to=</span><span class="fl">0.9</span>, <span class="at">length.out=</span><span class="dv">9</span>),fc<span class="sc">*</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="at">main=</span><span class="st">&quot;蒙特卡洛估算的相对误差&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;x&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;相对误差值(%)&quot;</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="at">from=</span><span class="fl">0.1</span>, <span class="at">to=</span><span class="fl">0.9</span>, <span class="at">length.out=</span><span class="dv">9</span>),fc<span class="sc">*</span><span class="dv">100</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>),<span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看出，误差很小。</p>
<p>\</p>
</div>
<div id="exercise-5.9" class="section level3">
<h3>Exercise 5.9</h3>
<p>使用之前建立过的Rayleigh函数进行估算</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span>;j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);y2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n);y3<span class="ot">&lt;-</span><span class="fu">numeric</span>(n);y4<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>sig<span class="ot">&lt;-</span><span class="dv">1</span>;</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>u0<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">5</span><span class="sc">*</span>n)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> u0[j<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    y1[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  }</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>}</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>  u <span class="ot">&lt;-</span> u0[j<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a>    y2[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a>  }</span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a>}</span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a>var1<span class="ot">=</span><span class="fu">var</span>((y1<span class="sc">+</span>y2)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a>j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;</span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">500</span>;</span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a>    y3[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a>  }</span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a>}</span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a>j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;</span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a>  j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span>sig<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">runif</span>(<span class="dv">1</span>),<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#random variate from g(.)</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a>  <span class="cf">if</span>  ((x<span class="sc">/</span>(sig)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))<span class="sc">/</span>(<span class="fl">2.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">/</span>sig)<span class="sc">/</span>sig)<span class="sc">&gt;</span> u) {<span class="co">#c=2.5</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a>    <span class="co">#we accept x</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb11-47"><a href="#cb11-47" tabindex="-1"></a>    y4[k] <span class="ot">&lt;-</span> x</span>
<span id="cb11-48"><a href="#cb11-48" tabindex="-1"></a>  }</span>
<span id="cb11-49"><a href="#cb11-49" tabindex="-1"></a>}</span>
<span id="cb11-50"><a href="#cb11-50" tabindex="-1"></a>var2<span class="ot">=</span><span class="fu">var</span>((y3<span class="sc">+</span>y4)<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p>通过上述计算得到在计算点数总数为1000点时，<span class="math inline">\(\frac{X+X&#39;}{2}\)</span>的方差为0.2076,而<span class="math inline">\(\frac{X_1+X_2}{2}\)</span>的方差为0.5076，可以得到Antithetic方法确实让方差降低了很多。
\</p>
</div>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<p>如下图，黑线为函数<span class="math inline">\(\frac{x^2}{\sqrt{2\pi}}e^{\frac{-x^2}{2}}\)</span>列出两个函数:<span class="math inline">\(g1(x)=\frac{1}{cos(1)+1}sin(x),x\to(1,\pi)\)</span>（图中红线）和<span class="math inline">\(g2(x)=e^{1-x},x\to(1,+\infty)\)</span>（图中绿线）</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>),<span class="dv">1</span>,<span class="dv">5</span>,<span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">cos</span>(<span class="dv">1</span>))<span class="sc">*</span><span class="fu">sin</span>(x),<span class="dv">1</span>,<span class="dv">5</span>,,<span class="at">col=</span><span class="dv">2</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x),<span class="dv">1</span>,<span class="dv">5</span>,,<span class="at">col=</span><span class="dv">3</span>,<span class="at">add=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>对它们分别进行重要性采样</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e5</span>;k<span class="ot">&lt;-</span><span class="dv">1</span>;y1<span class="ot">&lt;-</span>y2<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="cf">while</span>(k<span class="sc">&lt;=</span>n){</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  y1[k]<span class="ot">&lt;-</span> <span class="fu">acos</span>(<span class="fu">cos</span>(<span class="dv">1</span>)<span class="sc">-</span>(<span class="fu">cos</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>u);</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>  <span class="cf">if</span>(y1[k]<span class="sc">&gt;=</span><span class="dv">1</span>){</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span> y1[k];</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>  y2[k]<span class="ot">&lt;-</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">cos</span>(<span class="dv">1</span>))<span class="sc">*</span><span class="fu">sin</span>(x))</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>  }</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>  }</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">mean</span>(y2)</span></code></pre></div>
<pre><code>## [1] 0.3908627</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">var</span>(y2)</span></code></pre></div>
<pre><code>## [1] 0.007382134</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e5</span>;k<span class="ot">&lt;-</span><span class="dv">1</span>;y1<span class="ot">&lt;-</span>y3<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="cf">while</span>(k<span class="sc">&lt;=</span>n){</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  u<span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  y1[k]<span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">log</span>(u,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>));</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>  <span class="cf">if</span>(y1[k]<span class="sc">&gt;=</span><span class="dv">1</span>){</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  x<span class="ot">&lt;-</span> y1[k];</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  y3[k]<span class="ot">&lt;-</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  k<span class="ot">=</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>  }</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a>  }</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="fu">mean</span>(y3)</span></code></pre></div>
<pre><code>## [1] 0.4002509</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">var</span>(y3)</span></code></pre></div>
<pre><code>## [1] 0.02487725</code></pre>
<p>得到两者的值分别为<strong>0.390</strong>和<strong>0.401</strong>，均与标准值<strong>0.399</strong>相差很近。但前者方差为<strong>0.006</strong>，后者为<strong>0.024</strong>，所以前者的模型更好，其原因是函数更加贴近真实曲线。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span>;u<span class="ot">&lt;-</span><span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>x<span class="ot">&lt;-</span>(u<span class="sc">&gt;</span><span class="dv">1</span>)<span class="sc">*</span>u</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>y4<span class="ot">&lt;-</span><span class="fu">mean</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
</div>
<div id="monte-carlo-experiment" class="section level3">
<h3>Monte Carlo Experiment</h3>
<p>对快速排序法进行编程：</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">library</span>(tictoc)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>fastsort <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>    <span class="cf">if</span>(<span class="fu">length</span>(x)<span class="sc">&lt;=</span><span class="dv">1</span>)<span class="fu">return</span>(x)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>    x0 <span class="ot">&lt;-</span> x[<span class="dv">1</span>]</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>    loc <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>    low <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>    high <span class="ot">&lt;-</span> n</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>    <span class="cf">while</span>(low <span class="sc">!=</span> high){</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>        </span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>        <span class="cf">if</span>(loc <span class="sc">==</span> low){</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>            <span class="cf">if</span>(x[high] <span class="sc">&lt;</span> x[loc]){</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>                tmp <span class="ot">&lt;-</span> x[high]</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>                x[high] <span class="ot">&lt;-</span> x[loc]</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>                x[loc] <span class="ot">&lt;-</span> tmp</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>                low <span class="ot">=</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>                loc <span class="ot">=</span> high</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>            }<span class="cf">else</span>{</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>                    high <span class="ot">=</span> high <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>                }</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>            }<span class="cf">else</span>{</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>                <span class="cf">if</span>(x[low] <span class="sc">&gt;</span> x[loc]){</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>                    tmp <span class="ot">&lt;-</span> x[low]</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>                    x[low] <span class="ot">&lt;-</span> x[loc]</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>                    x[loc] <span class="ot">&lt;-</span> tmp</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>                    high <span class="ot">=</span> high <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>                    loc <span class="ot">=</span> low</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>                }<span class="cf">else</span>{</span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a>                    low <span class="ot">=</span> low<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a>                }</span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a>           }</span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a>        }</span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a>    L <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a>    R <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&gt;</span><span class="dv">1</span>) L <span class="ot">=</span> x[<span class="dv">1</span><span class="sc">:</span>(low<span class="dv">-1</span>)]</span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a>    <span class="cf">if</span>(low<span class="sc">&lt;</span><span class="fu">length</span>(x)) R <span class="ot">=</span> x[(low<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]</span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">fastsort</span>(L),x[low],<span class="fu">fastsort</span>(R)))</span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a>}</span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="cf">for</span>(n <span class="cf">in</span> <span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>)){</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a> </span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a>  <span class="fu">tic</span>()</span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">10</span>)){</span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a>    m<span class="ot">&lt;-</span><span class="fu">sample</span>(n,<span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a>    <span class="fu">fastsort</span>(m)</span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a>  }</span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a>  <span class="fu">toc</span>()</span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 0.25 sec elapsed
## 0.52 sec elapsed
## 1.03 sec elapsed
## 1.58 sec elapsed
## 2.18 sec elapsed</code></pre>
<p>对所得数据进行回归,如下图，其中散点为数据点，黑线为<span class="math inline">\(xlog(x)\)</span>的回归曲线，可以看到时间和复杂度的拟合程度很一致：</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>timq<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.28</span>,<span class="fl">0.5</span>,<span class="fl">1.07</span>,<span class="fl">1.56</span>,<span class="fl">2.14</span>);</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>),<span class="fu">c</span>(<span class="fl">0.28</span>,<span class="fl">0.5</span>,<span class="fl">1.07</span>,<span class="fl">1.56</span>,<span class="fl">2.14</span>),<span class="at">main=</span><span class="st">&quot;calculation time&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;n&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;time&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">1e4</span>,<span class="fl">2e4</span>,<span class="fl">4e4</span>,<span class="fl">6e4</span>,<span class="fl">8e4</span>);</span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.28</span>,<span class="fl">0.5</span>,<span class="fl">1.07</span>,<span class="fl">1.56</span>,<span class="fl">2.14</span>);</span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a>regmodel<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="at">formula=</span>y<span class="sc">~</span>x<span class="sc">*</span><span class="fu">log</span>(x))</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="at">from=</span><span class="fl">1e4</span>,<span class="at">to=</span><span class="fl">1e5</span>)</span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a>y1<span class="ot">&lt;-</span><span class="fu">predict</span>(regmodel,<span class="at">newdata=</span><span class="fu">list</span>(<span class="at">x=</span><span class="fu">seq</span>(</span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a>  <span class="at">from=</span><span class="fl">1e4</span>,<span class="at">to=</span><span class="fl">1e5</span>)))</span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="fu">matlines</span>(x,y1, <span class="at">lwd=</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="assignment-4" class="section level2">
<h2>Assignment 4</h2>
<div id="exercise-6.6" class="section level3">
<h3>Exercise 6.6</h3>
<p>生成均值为0，标准差为1，偏度为0.5的偏正态分布：</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">library</span>(sn)</span></code></pre></div>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## 
## Attaching package: &#39;sn&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     sd</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span>; beta <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># alternative hypothesis!</span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>    m <span class="ot">&lt;-</span> <span class="fl">1e3</span>; n <span class="ot">&lt;-</span> <span class="dv">10</span>; <span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>    beta.hat <span class="ot">&lt;-</span> beta.se <span class="ot">&lt;-</span> p.val1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>      y <span class="ot">&lt;-</span> alpha <span class="sc">+</span> beta <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rsn</span>(n,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>      coe <span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x))<span class="sc">$</span>coef</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>      beta.hat[i] <span class="ot">&lt;-</span> coe[<span class="dv">2</span>,<span class="dv">1</span>];beta.se[i] <span class="ot">&lt;-</span> coe[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>      p.val1[i] <span class="ot">&lt;-</span> coe[<span class="dv">2</span>,<span class="dv">4</span>] <span class="co"># t-test p-value</span></span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>    }</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>   <span class="co"># p.val2 &lt;- 2*(1-pt(abs(beta.hat/beta.se),n-2))</span></span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">c</span>(<span class="fu">mean</span>(p.val1<span class="sc">&lt;=</span><span class="fl">0.025</span>),<span class="fu">mean</span>(p.val1<span class="sc">&lt;=</span><span class="fl">0.05</span>),<span class="fu">mean</span>(p.val1<span class="sc">&lt;=</span><span class="fl">0.95</span>),<span class="fu">mean</span>(p.val1<span class="sc">&lt;=</span><span class="fl">0.975</span>)))</span></code></pre></div>
<pre><code>## [1] 0.525 0.657 0.999 0.999</code></pre>
<p>将得到的quantiles代入到(2.14)的公式:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>xq<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.525</span>,<span class="fl">0.657</span>,<span class="fl">0.999</span>,<span class="fl">0.999</span>);</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.095</span>,<span class="fl">0.0975</span>);</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e3</span>;</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>varq<span class="ot">&lt;-</span>q<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>q)<span class="sc">/</span>(n<span class="sc">*</span>xq);</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a><span class="fu">print</span>(varq)</span></code></pre></div>
<pre><code>## [1] 4.642857e-05 7.229833e-05 8.606106e-05 8.808183e-05</code></pre>
<p>在大样本下，<span class="math inline">\(\sqrt{b}\approx
N(0,6/n)\)</span>，其估算的quantiles为</p>
</div>
<div id="project-6-b" class="section level3">
<h3>Project 6-B</h3>
<p>效力分析，为什么非参数检验会降低效力？</p>
<p>答：因为非参数检验使用的信息变少了。</p>
</div>
<div id="class-question" class="section level3">
<h3>Class Question</h3>
<p>1.可以描述为假设方法2比方法1更有效的接受率为95%</p>
<p>2.应该使用<strong>McNemar
test</strong>。因为此问题属于两配对样本非参数检验一般用于同一研究对象（或两配对对象）分别给予两种不同处理的效果比较，以及同一研究对象（或两配对对象）处理前后的效果比较。前者推断两种效果有无差别，后者推断某种处理是否有效，所以使用McNemar
test。 ## Assignment 5</p>
</div>
</div>
<div id="assignment-5" class="section level2">
<h2>Assignment 5</h2>
<div id="课堂习题" class="section level3">
<h3>课堂习题</h3>
<table>
<thead>
<tr class="header">
<th></th>
<th>Bonferroni correction</th>
<th>B-H correction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FWER</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>FDR</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td>TPR</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
<div id="example-7.4" class="section level3">
<h3>Example 7.4</h3>
<p>设指数分布的密度函数是<span class="math display">\[\lambda
e^{-\lambda t}\]</span>则其最大似然估计:<span class="math display">\[\bar{\lambda}=\frac{n}{\sum_1^nt_i}\]</span>通过此公式可以使用bootstrap法：</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>theta.hat<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">18</span>,<span class="dv">43</span>,<span class="dv">85</span>,<span class="dv">91</span>,<span class="dv">98</span>,<span class="dv">100</span>,<span class="dv">130</span>,<span class="dv">230</span>,<span class="dv">487</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="dv">1000</span>;<span class="co">#large estimate</span></span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span></span>
<span id="cb33-5"><a href="#cb33-5" tabindex="-1"></a>blam<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb33-6"><a href="#cb33-6" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb33-7"><a href="#cb33-7" tabindex="-1"></a>  i<span class="ot">&lt;-</span><span class="fu">sample</span>(theta.hat,<span class="at">size=</span>n,<span class="at">replace=</span><span class="cn">TRUE</span>);</span>
<span id="cb33-8"><a href="#cb33-8" tabindex="-1"></a>  blam[b]<span class="ot">&lt;-</span>n<span class="sc">/</span><span class="fu">sum</span>(i)</span>
<span id="cb33-9"><a href="#cb33-9" tabindex="-1"></a>}</span>
<span id="cb33-10"><a href="#cb33-10" tabindex="-1"></a>mse<span class="ot">&lt;-</span><span class="fu">sd</span>(blam)</span>
<span id="cb33-11"><a href="#cb33-11" tabindex="-1"></a>bia<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="dv">10</span><span class="sc">/</span><span class="fu">sum</span>(theta.hat)<span class="sc">-</span>blam)</span>
<span id="cb33-12"><a href="#cb33-12" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(mse,bia))</span></code></pre></div>
<pre><code>## [1]  0.0001118744 -0.0015423557</code></pre>
<table>
<thead>
<tr class="header">
<th>均方差</th>
<th>偏差</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.0001153</td>
<td>-0.00153</td>
</tr>
</tbody>
</table>
</div>
<div id="example-7.5" class="section level3">
<h3>Example 7.5</h3>
<p>通过将7.4的值取倒数</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>theta1.hat<span class="ot">&lt;-</span>theta.hat</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>theta1.boot<span class="ot">&lt;-</span><span class="cf">function</span>(dat,ind){</span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a> i<span class="ot">&lt;-</span><span class="fu">sample</span>(dat,<span class="at">size=</span><span class="fl">1e4</span>,<span class="at">replace=</span><span class="cn">TRUE</span>);</span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a> result<span class="ot">&lt;-</span><span class="fu">sum</span>(i)<span class="sc">/</span><span class="fl">1e4</span></span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a> <span class="fu">return</span>(result)</span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>boot.obj<span class="ot">&lt;-</span><span class="fu">boot</span>(theta1.hat,theta1.boot,<span class="at">R=</span><span class="dv">1000</span>)</span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a><span class="fu">boot.ci</span>(boot.obj,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.obj, type = c(&quot;basic&quot;, &quot;norm&quot;, &quot;perc&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   (106.0, 111.3 )   (106.1, 111.3 )  
## 
## Level     Percentile            BCa          
## 95%   (105.3, 110.5 )   (106.1, 111.2 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<table>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th>Normal</th>
<th>Basic</th>
<th>Percentile</th>
<th>BCa</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(106,9 , 112.1)</td>
<td>(107.0 , 112.1)</td>
<td>(105.6 , 110.6)</td>
<td>(106.8 , 112.0)</td>
</tr>
</tbody>
</table>
<p>出现差异，原因可能有: 1.样本数据大小 2.原数据方差等 ## Assignment 6
### Example7.8</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a>data1<span class="ot">&lt;-</span>scor</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a>covd<span class="ot">&lt;-</span><span class="fu">cov</span>(data1)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>lambdaeig<span class="ot">&lt;-</span><span class="fu">eigen</span>(covd,<span class="at">only.values =</span> <span class="cn">TRUE</span>)</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a>lambda.hat<span class="ot">&lt;-</span>lambdaeig<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambdaeig<span class="sc">$</span>values)</span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span>;</span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a>lambda.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n);</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>      covjack <span class="ot">&lt;-</span> <span class="fu">cov</span>(data1[(<span class="dv">1</span><span class="sc">:</span><span class="dv">88</span>)[<span class="sc">-</span>i],<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>      jacklam<span class="ot">&lt;-</span><span class="fu">eigen</span>(covjack,<span class="at">only.values=</span><span class="cn">TRUE</span>)</span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>      jacklam<span class="ot">&lt;-</span>jacklam<span class="sc">$</span>values</span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>      lambda.jack[i]<span class="ot">&lt;-</span>jacklam[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(jacklam)</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>    }</span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>    bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(lambda.jack)<span class="sc">-</span>lambda.hat)</span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>    se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((lambda.jack<span class="sc">-</span>lambda.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>lambda.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
</div>
<div id="assignment-6" class="section level2">
<h2>Assignment 6</h2>
<div id="example7.8" class="section level3">
<h3>Example7.8</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>data1<span class="ot">&lt;-</span>scor</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>covd<span class="ot">&lt;-</span><span class="fu">cov</span>(data1)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>lambdaeig<span class="ot">&lt;-</span><span class="fu">eigen</span>(covd,<span class="at">only.values =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>lambda.hat<span class="ot">&lt;-</span>lambdaeig<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambdaeig<span class="sc">$</span>values)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fl">1e4</span>;</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>lambda.jack<span class="ot">&lt;-</span><span class="fu">numeric</span>(n);</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>      covjack <span class="ot">&lt;-</span> <span class="fu">cov</span>(data1[(<span class="dv">1</span><span class="sc">:</span><span class="dv">88</span>)[<span class="sc">-</span>i],<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>      jacklam<span class="ot">&lt;-</span><span class="fu">eigen</span>(covjack,<span class="at">only.values=</span><span class="cn">TRUE</span>)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>      jacklam<span class="ot">&lt;-</span>jacklam<span class="sc">$</span>values</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>      lambda.jack[i]<span class="ot">&lt;-</span>jacklam[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(jacklam)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>    }</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>    bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(lambda.jack)<span class="sc">-</span>lambda.hat)</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>    se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((lambda.jack<span class="sc">-</span>lambda.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>lambda.hat,<span class="at">bias.jack=</span>bias.jack,<span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.619     0.001     0.050</code></pre>
</div>
<div id="example-7.10" class="section level3">
<h3>Example 7.10</h3>
<p>本题选取的四个模型分别为:</p>
<ol style="list-style-type: decimal">
<li><p>Linear: <span class="math inline">\(Y=\beta_0+\beta_1
X+\epsilon\)</span></p></li>
<li><p>Quadratic: <span class="math inline">\(Y=\beta_0+\beta_1
X+\beta_2 X^2+\epsilon\)</span></p></li>
<li><p>Exponential: <span class="math inline">\(\log (Y)
=\beta_0+\beta_1 X+\epsilon\)</span></p></li>
<li><p>Cubic Polynomial: <span class="math inline">\(Y=\beta_0+\beta_1
X+\beta_2 X^2+\beta_3 X^3+\epsilon\)</span></p></li>
</ol>
<p>进行R语言编程：</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, .<span class="dv">1</span>) </span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="fu">library</span>(DAAG,<span class="at">quietly=</span><span class="cn">TRUE</span>);</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="fu">attach</span>(ironslag)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>L1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>yhat1 <span class="ot">&lt;-</span> L1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a>L2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>yhat2 <span class="ot">&lt;-</span> L2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>L3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(magnetic) <span class="sc">~</span> chemical)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>logyhat3 <span class="ot">&lt;-</span> L3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(magnetic <span class="sc">~</span> chemical <span class="sc">+</span> <span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(chemical<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>yhat4<span class="ot">&lt;-</span>L4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> a <span class="sc">+</span> L4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> a<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>L4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>a<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)   <span class="co">#in DAAG ironslag</span></span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a> e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a> <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>        y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>        x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a></span>
<span id="cb41-21"><a href="#cb41-21" tabindex="-1"></a>        J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb41-22"><a href="#cb41-22" tabindex="-1"></a>        yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb41-23"><a href="#cb41-23" tabindex="-1"></a>        e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb41-24"><a href="#cb41-24" tabindex="-1"></a></span>
<span id="cb41-25"><a href="#cb41-25" tabindex="-1"></a>        J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb41-26"><a href="#cb41-26" tabindex="-1"></a>        yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span></span>
<span id="cb41-27"><a href="#cb41-27" tabindex="-1"></a>                J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb41-28"><a href="#cb41-28" tabindex="-1"></a>        e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb41-29"><a href="#cb41-29" tabindex="-1"></a></span>
<span id="cb41-30"><a href="#cb41-30" tabindex="-1"></a>        J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb41-31"><a href="#cb41-31" tabindex="-1"></a>        logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb41-32"><a href="#cb41-32" tabindex="-1"></a>        yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb41-33"><a href="#cb41-33" tabindex="-1"></a>        e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb41-34"><a href="#cb41-34" tabindex="-1"></a></span>
<span id="cb41-35"><a href="#cb41-35" tabindex="-1"></a>        J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb41-36"><a href="#cb41-36" tabindex="-1"></a>        yhat4<span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">2</span>]<span class="sc">*</span>chemical[k]<span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">3</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span>J4<span class="sc">$</span>coef[<span class="dv">4</span>]<span class="sc">*</span>chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb41-37"><a href="#cb41-37" tabindex="-1"></a>        e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb41-38"><a href="#cb41-38" tabindex="-1"></a>    }</span>
<span id="cb41-39"><a href="#cb41-39" tabindex="-1"></a></span>
<span id="cb41-40"><a href="#cb41-40" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>由计算得cubic-polynomial得偏差最小，所以应选取cubic-polynomial模型</p>
</div>
<div id="example-8.1" class="section level3">
<h3>Example 8.1</h3>
<p>对EX8.1使用Cram´er-von Mises test：</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a><span class="fu">library</span>(goftest)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>;z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y);K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>;n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>); method <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);t0 <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x, y)[<span class="dv">1</span>]</span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[k]; y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z);</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  }</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span><span class="fu">cvm_test</span>(x1, y1)[<span class="dv">1</span>]</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>}</span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">cmvtest=</span>p,<span class="fu">cvm_test</span>(x,y)[<span class="dv">2</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## cmvtest P-Value 
##   0.398   0.401</code></pre>
<p>对EX8.2使用Cram´er-von Mises test：</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">library</span>(goftest)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>;z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y);K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>;D<span class="ot">&lt;-</span><span class="fu">numeric</span>(R)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>D0 <span class="ot">&lt;-</span> <span class="fu">cvm_test</span>(x, y)[<span class="dv">1</span>]</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> z[k]</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k]</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>D[i]<span class="ot">&lt;-</span><span class="fu">cvm_test</span>(x1, y1)[<span class="dv">1</span>]</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>}</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">mean</span>(<span class="fu">c</span>(D0,D)<span class="sc">&gt;=</span>D0)</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="fu">options</span>(<span class="at">warn=</span><span class="dv">0</span>)</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">cvmtest=</span>p,<span class="fu">cvm_test</span>(x,y)[<span class="dv">2</span>]),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## cvmtest P-Value 
##   0.421   0.404</code></pre>
</div>
<div id="example-8.2" class="section level3">
<h3>Example 8.2</h3>
<p>对原分布使用t-test,然后进行spearman检验</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">library</span>(goftest)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;sunflower&quot;</span>]))</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb47-7"><a href="#cb47-7" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb47-8"><a href="#cb47-8" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">999</span>;z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y);K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>;n<span class="ot">&lt;-</span><span class="fu">length</span>(x);</span>
<span id="cb47-10"><a href="#cb47-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>); method <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-11"><a href="#cb47-11" tabindex="-1"></a>reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R); t0 <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, y)<span class="sc">$</span>statistic</span>
<span id="cb47-12"><a href="#cb47-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb47-13"><a href="#cb47-13" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z);</span>
<span id="cb47-14"><a href="#cb47-14" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb47-15"><a href="#cb47-15" tabindex="-1"></a>  reps[i] <span class="ot">&lt;-</span><span class="fu">t.test</span>(x1, y1)<span class="sc">$</span>statistic</span>
<span id="cb47-16"><a href="#cb47-16" tabindex="-1"></a>}</span>
<span id="cb47-17"><a href="#cb47-17" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb47-18"><a href="#cb47-18" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" tabindex="-1"></a>reps1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R);t0 <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb47-20"><a href="#cb47-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb47-21"><a href="#cb47-21" tabindex="-1"></a>  <span class="cf">if</span>(method<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb47-22"><a href="#cb47-22" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-23"><a href="#cb47-23" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> z[k]; y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] <span class="co">#complement of x1</span></span>
<span id="cb47-24"><a href="#cb47-24" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb47-25"><a href="#cb47-25" tabindex="-1"></a>    xy <span class="ot">&lt;-</span> <span class="fu">sample</span>(z);</span>
<span id="cb47-26"><a href="#cb47-26" tabindex="-1"></a>    x1 <span class="ot">&lt;-</span> xy[<span class="dv">1</span><span class="sc">:</span>n]; y1 <span class="ot">&lt;-</span> xy[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>n)]</span>
<span id="cb47-27"><a href="#cb47-27" tabindex="-1"></a>  }</span>
<span id="cb47-28"><a href="#cb47-28" tabindex="-1"></a>  reps1[i] <span class="ot">&lt;-</span><span class="fu">cor</span>(x1, y1,<span class="at">method=</span><span class="st">&#39;spearman&#39;</span>)</span>
<span id="cb47-29"><a href="#cb47-29" tabindex="-1"></a>}</span>
<span id="cb47-30"><a href="#cb47-30" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(<span class="fu">c</span>(t0, reps1)) <span class="sc">&gt;=</span> <span class="fu">abs</span>(t0))</span>
<span id="cb47-31"><a href="#cb47-31" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">p=</span>p1,<span class="at">spearman_p=</span>p2),<span class="dv">5</span>)</span></code></pre></div>
<pre><code>##          p spearman_p 
##      0.001      0.001</code></pre>
<p>结果相差不大</p>
</div>
</div>
<div id="assignment-7" class="section level2">
<h2>Assignment 7</h2>
<div id="example-9.3" class="section level3">
<h3>Example 9.3</h3>
<p>使用M-H采样对Cauchy分布的采样：</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以保证结果可重复</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="co"># 定义标准柯西分布的概率密度函数</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>dcauchy_standard <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> x<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>}</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a><span class="co"># Metropolis-Hastings算法实现</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(start, iterations, proposal_sd, burn_in) {</span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(iterations)</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> start</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a>  current_x <span class="ot">&lt;-</span> start</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  </span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>iterations) {</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>    <span class="co"># 使用正态分布作为建议分布生成候选样本</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>    proposal_x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current_x, <span class="at">sd =</span> proposal_sd)</span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>    </span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>    <span class="co"># 计算接受概率</span></span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">dcauchy_standard</span>(proposal_x) <span class="sc">/</span> <span class="fu">dcauchy_standard</span>(current_x)</span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>    acceptance_probability <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="dv">1</span>, acceptance_ratio)</span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a>    </span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a>    <span class="co"># 接受或拒绝候选样本</span></span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_probability) {</span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a>      current_x <span class="ot">&lt;-</span> proposal_x</span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a>    }</span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a>    </span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a>    samples[i] <span class="ot">&lt;-</span> current_x</span>
<span id="cb49-28"><a href="#cb49-28" tabindex="-1"></a>  }</span>
<span id="cb49-29"><a href="#cb49-29" tabindex="-1"></a>  </span>
<span id="cb49-30"><a href="#cb49-30" tabindex="-1"></a>  <span class="co"># 舍弃前burn_in个样本</span></span>
<span id="cb49-31"><a href="#cb49-31" tabindex="-1"></a>  <span class="fu">return</span>(samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>iterations])</span>
<span id="cb49-32"><a href="#cb49-32" tabindex="-1"></a>}</span>
<span id="cb49-33"><a href="#cb49-33" tabindex="-1"></a></span>
<span id="cb49-34"><a href="#cb49-34" tabindex="-1"></a><span class="co"># 使用Metropolis-Hastings算法进行抽样</span></span>
<span id="cb49-35"><a href="#cb49-35" tabindex="-1"></a>start_value <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 初始值</span></span>
<span id="cb49-36"><a href="#cb49-36" tabindex="-1"></a>iterations <span class="ot">&lt;-</span> <span class="dv">11000</span>  <span class="co"># 总迭代次数，包括烧入期</span></span>
<span id="cb49-37"><a href="#cb49-37" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 舍弃的初始样本数</span></span>
<span id="cb49-38"><a href="#cb49-38" tabindex="-1"></a>proposal_sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 建议分布的标准差</span></span>
<span id="cb49-39"><a href="#cb49-39" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(start_value, iterations, proposal_sd, burn_in)</span>
<span id="cb49-41"><a href="#cb49-41" tabindex="-1"></a></span>
<span id="cb49-42"><a href="#cb49-42" tabindex="-1"></a><span class="co"># 绘制抽样结果的直方图</span></span>
<span id="cb49-43"><a href="#cb49-43" tabindex="-1"></a><span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Metropolis-Hastings Sampling of Cauchy Distribution&quot;</span>,</span>
<span id="cb49-44"><a href="#cb49-44" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb49-45"><a href="#cb49-45" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dcauchy_standard</span>(x), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-9.8" class="section level3">
<h3>Example 9.8</h3>
<p>得到如下的抽样图</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a><span class="co"># 定义参数</span></span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># 二项分布的试验次数</span></span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Beta分布的参数a</span></span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Beta分布的参数b</span></span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 采样次数</span></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co"># 烧入期</span></span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a><span class="co"># 初始化</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb50-14"><a href="#cb50-14" tabindex="-1"></a>x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, a, b) <span class="sc">*</span> n  <span class="co"># 初始x值</span></span>
<span id="cb50-15"><a href="#cb50-15" tabindex="-1"></a>y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x_samples[<span class="dv">1</span>] <span class="sc">/</span> n)  <span class="co"># 初始y值</span></span>
<span id="cb50-16"><a href="#cb50-16" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" tabindex="-1"></a><span class="co"># 吉布斯采样</span></span>
<span id="cb50-18"><a href="#cb50-18" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb50-19"><a href="#cb50-19" tabindex="-1"></a>  <span class="co"># 从条件二项分布中采样y</span></span>
<span id="cb50-20"><a href="#cb50-20" tabindex="-1"></a>  y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x_samples[i<span class="dv">-1</span>] <span class="sc">/</span> n)</span>
<span id="cb50-21"><a href="#cb50-21" tabindex="-1"></a>  </span>
<span id="cb50-22"><a href="#cb50-22" tabindex="-1"></a>  <span class="co"># 从条件Beta分布中采样x</span></span>
<span id="cb50-23"><a href="#cb50-23" tabindex="-1"></a>  x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, y_samples[i] <span class="sc">+</span> a, n <span class="sc">-</span> y_samples[i] <span class="sc">+</span> b) <span class="sc">*</span> n</span>
<span id="cb50-24"><a href="#cb50-24" tabindex="-1"></a>}</span>
<span id="cb50-25"><a href="#cb50-25" tabindex="-1"></a></span>
<span id="cb50-26"><a href="#cb50-26" tabindex="-1"></a><span class="co"># 丢弃烧入期样本</span></span>
<span id="cb50-27"><a href="#cb50-27" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> x_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb50-28"><a href="#cb50-28" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> y_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb50-29"><a href="#cb50-29" tabindex="-1"></a></span>
<span id="cb50-30"><a href="#cb50-30" tabindex="-1"></a><span class="co"># 绘制样本的散点图</span></span>
<span id="cb50-31"><a href="#cb50-31" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_samples, <span class="at">y =</span> y_samples)</span>
<span id="cb50-32"><a href="#cb50-32" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb50-33"><a href="#cb50-33" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb50-34"><a href="#cb50-34" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gibbs Sampling of Bivariate Distribution&quot;</span>,</span>
<span id="cb50-35"><a href="#cb50-35" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-36"><a href="#cb50-36" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="例题" class="section level3">
<h3>例题</h3>
<p>GR检测合格</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co"># 安装coda包（如果尚未安装）</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;coda&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;coda&quot;</span>)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>}</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a><span class="co"># 加载coda包</span></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="co"># 定义参数</span></span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>num_chains <span class="ot">&lt;-</span> <span class="dv">3</span>  <span class="co"># 运行的链数量</span></span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a></span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a><span class="co"># 初始化存储链的列表</span></span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">&quot;list&quot;</span>, num_chains)</span>
<span id="cb51-19"><a href="#cb51-19" tabindex="-1"></a></span>
<span id="cb51-20"><a href="#cb51-20" tabindex="-1"></a><span class="co"># 运行多个独立的吉布斯采样链</span></span>
<span id="cb51-21"><a href="#cb51-21" tabindex="-1"></a><span class="cf">for</span> (chain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_chains) {</span>
<span id="cb51-22"><a href="#cb51-22" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb51-23"><a href="#cb51-23" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb51-24"><a href="#cb51-24" tabindex="-1"></a>  x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, a, b) <span class="sc">*</span> n</span>
<span id="cb51-25"><a href="#cb51-25" tabindex="-1"></a>  y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x_samples[<span class="dv">1</span>] <span class="sc">/</span> n)</span>
<span id="cb51-26"><a href="#cb51-26" tabindex="-1"></a>  </span>
<span id="cb51-27"><a href="#cb51-27" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb51-28"><a href="#cb51-28" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x_samples[i<span class="dv">-1</span>] <span class="sc">/</span> n)</span>
<span id="cb51-29"><a href="#cb51-29" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, y_samples[i] <span class="sc">+</span> a, n <span class="sc">-</span> y_samples[i] <span class="sc">+</span> b) <span class="sc">*</span> n</span>
<span id="cb51-30"><a href="#cb51-30" tabindex="-1"></a>  }</span>
<span id="cb51-31"><a href="#cb51-31" tabindex="-1"></a>  </span>
<span id="cb51-32"><a href="#cb51-32" tabindex="-1"></a>  <span class="co"># 丢弃烧入期样本</span></span>
<span id="cb51-33"><a href="#cb51-33" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> x_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb51-34"><a href="#cb51-34" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> y_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb51-35"><a href="#cb51-35" tabindex="-1"></a>  </span>
<span id="cb51-36"><a href="#cb51-36" tabindex="-1"></a>  <span class="co"># 将链存为mcmc对象</span></span>
<span id="cb51-37"><a href="#cb51-37" tabindex="-1"></a>  chains[[chain]] <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="fu">cbind</span>(x_samples, y_samples))</span>
<span id="cb51-38"><a href="#cb51-38" tabindex="-1"></a>}</span>
<span id="cb51-39"><a href="#cb51-39" tabindex="-1"></a></span>
<span id="cb51-40"><a href="#cb51-40" tabindex="-1"></a><span class="co"># 计算Gelman-Rubin诊断</span></span>
<span id="cb51-41"><a href="#cb51-41" tabindex="-1"></a>gelman_diag <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(<span class="fu">mcmc.list</span>(chains), <span class="at">autoburnin =</span> <span class="cn">FALSE</span>)</span>
<span id="cb51-42"><a href="#cb51-42" tabindex="-1"></a></span>
<span id="cb51-43"><a href="#cb51-43" tabindex="-1"></a><span class="co"># 输出Gelman-Rubin诊断结果</span></span>
<span id="cb51-44"><a href="#cb51-44" tabindex="-1"></a><span class="fu">print</span>(gelman_diag)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##           Point est. Upper C.I.
## x_samples          1          1
## y_samples          1          1
## 
## Multivariate psrf
## 
## 1</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># 检查收敛性</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">all</span>(gelman_diag<span class="sc">$</span>psrf[, <span class="st">&quot;Point est.&quot;</span>] <span class="sc">&lt;</span> <span class="fl">1.2</span>)) {</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have converged according to Gelman-Rubin diagnostic.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Chains have NOT converged yet. Consider running for more iterations.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Chains have converged according to Gelman-Rubin diagnostic.</code></pre>
</div>
</div>
<div id="assignment-8" class="section level2">
<h2>Assignment 8</h2>
<div id="example-11.3" class="section level3">
<h3>Example 11.3</h3>
<ol style="list-style-type: decimal">
<li>原式<span class="math inline">\(\frac{(-1)^{k}}{k!2^{k}}
\frac{\|a\|^{2 k+2}}{(2 k+1)(2 k+2)}
\frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}\)</span>可改写为:<span class="math inline">\(\frac{(-1)^{k}}{(2 k+1)(2 k+2)} \frac{\|a\|^{2
k+2}\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{k!2^{k}\Gamma\left(k+\frac{d}{2}+1\right)}\)</span>，其中<span class="math inline">\(\frac{\|a\|^{2
k+2}\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{k!2^{k}\Gamma\left(k+\frac{d}{2}+1\right)}=e^{(2k+2)ln\|a\|+ln\Gamma(\frac{d+1}{2})+ln\Gamma\left(k+\frac{3}{2}\right)-kln2-\Sigma
lnk-ln\Gamma\left(k+\frac{d}{2}+1\right)}\)</span></li>
</ol>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># 定义函数</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1000</span>;</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">100</span>;</span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>);</span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>a_norm<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>resul<span class="ot">&lt;-</span>((<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> <span class="fu">factorial</span>(k) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">^</span>k)<span class="sc">*</span>(a_norm<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>)) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))<span class="sc">*</span><span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>term1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>term2 <span class="ot">&lt;-</span> <span class="fu">exp</span>( (<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(a_norm,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>))<span class="sc">+</span><span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">:</span>k,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>))) <span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>))<span class="sc">-</span><span class="fu">lgamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>resul1<span class="ot">&lt;-</span>term1<span class="sc">*</span>term2</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="fu">c</span>(resul,resul1)</span></code></pre></div>
<pre><code>## [1] NaN   0</code></pre>
<p>结果显示未经处理的结果显示为NaN，经处理后能正常显示。</p>
<p>(2)设k从1加到10000，d=100，计算求和式：</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>k<span class="ot">&lt;-</span><span class="dv">1000</span>;</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="dv">100</span>;</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>term3<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="fl">1e3</span>)</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fl">1e3</span>){</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>term1<span class="ot">&lt;-</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>term2<span class="ot">&lt;-</span><span class="fu">exp</span>( (<span class="dv">2</span><span class="sc">*</span>k<span class="sc">+</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">log</span>(a_norm,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>))<span class="sc">+</span><span class="fu">lgamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">+</span><span class="fu">lgamma</span>(k <span class="sc">+</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">-</span> <span class="fu">sum</span>(<span class="fu">log</span>(<span class="dv">1</span><span class="sc">:</span>k,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>))) <span class="sc">-</span>k<span class="sc">*</span><span class="fu">log</span>(<span class="dv">2</span>,<span class="at">base=</span><span class="fu">exp</span>(<span class="dv">1</span>))<span class="sc">-</span><span class="fu">lgamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>term3[k]<span class="ot">&lt;-</span>term1<span class="sc">*</span>term2</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>}</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>sumresul<span class="ot">&lt;-</span><span class="fu">sum</span>(term3)</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>sumresul</span></code></pre></div>
<pre><code>## [1] -0.00374078</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>因为(2)已经将a设为(1,2)，所以得到的值就为-0.00374</li>
</ol>
</div>
<div id="example-11.5" class="section level3">
<h3>Example 11.5</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a><span class="co"># 定义 k 的值</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># 你可以根据需要修改这个值</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a><span class="co"># 定义 c_k 函数，增加对 a 的限制</span></span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>  <span class="cf">if</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;=</span> k <span class="sc">+</span> <span class="dv">1</span>) {</span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 返回 NA 以避免后续计算出错</span></span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>  }</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>}</span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a></span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a><span class="co"># 定义左侧的积分函数</span></span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>left_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>  c_k_value <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k)</span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(c_k_value)) {</span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 如果 c_k_value 是 NA，返回 NA</span></span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>  }</span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>  </span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a>  }</span>
<span id="cb59-25"><a href="#cb59-25" tabindex="-1"></a>  integral_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand, <span class="dv">0</span>, c_k_value)<span class="sc">$</span>value</span>
<span id="cb59-26"><a href="#cb59-26" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))) <span class="sc">*</span> integral_value)</span>
<span id="cb59-27"><a href="#cb59-27" tabindex="-1"></a>}</span>
<span id="cb59-28"><a href="#cb59-28" tabindex="-1"></a></span>
<span id="cb59-29"><a href="#cb59-29" tabindex="-1"></a><span class="co"># 定义右侧的积分函数</span></span>
<span id="cb59-30"><a href="#cb59-30" tabindex="-1"></a>right_integral <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb59-31"><a href="#cb59-31" tabindex="-1"></a>  c_k_value <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k)</span>
<span id="cb59-32"><a href="#cb59-32" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(c_k_value)) {</span>
<span id="cb59-33"><a href="#cb59-33" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 如果 c_k_value 是 NA，返回 NA</span></span>
<span id="cb59-34"><a href="#cb59-34" tabindex="-1"></a>  }</span>
<span id="cb59-35"><a href="#cb59-35" tabindex="-1"></a>  </span>
<span id="cb59-36"><a href="#cb59-36" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) {</span>
<span id="cb59-37"><a href="#cb59-37" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb59-38"><a href="#cb59-38" tabindex="-1"></a>  }</span>
<span id="cb59-39"><a href="#cb59-39" tabindex="-1"></a>  integral_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand, <span class="dv">0</span>, c_k_value)<span class="sc">$</span>value</span>
<span id="cb59-40"><a href="#cb59-40" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>))) <span class="sc">*</span> integral_value)</span>
<span id="cb59-41"><a href="#cb59-41" tabindex="-1"></a>}</span>
<span id="cb59-42"><a href="#cb59-42" tabindex="-1"></a></span>
<span id="cb59-43"><a href="#cb59-43" tabindex="-1"></a><span class="co"># 定义方程</span></span>
<span id="cb59-44"><a href="#cb59-44" tabindex="-1"></a>equation <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb59-45"><a href="#cb59-45" tabindex="-1"></a>  left <span class="ot">&lt;-</span> <span class="fu">left_integral</span>(a, k)</span>
<span id="cb59-46"><a href="#cb59-46" tabindex="-1"></a>  right <span class="ot">&lt;-</span> <span class="fu">right_integral</span>(a, k)</span>
<span id="cb59-47"><a href="#cb59-47" tabindex="-1"></a>  </span>
<span id="cb59-48"><a href="#cb59-48" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(left) <span class="sc">||</span> <span class="fu">is.na</span>(right)) {</span>
<span id="cb59-49"><a href="#cb59-49" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)  <span class="co"># 如果任一侧是 NA，返回 NA</span></span>
<span id="cb59-50"><a href="#cb59-50" tabindex="-1"></a>  }</span>
<span id="cb59-51"><a href="#cb59-51" tabindex="-1"></a>  </span>
<span id="cb59-52"><a href="#cb59-52" tabindex="-1"></a>  <span class="fu">return</span>(left <span class="sc">-</span> right)</span>
<span id="cb59-53"><a href="#cb59-53" tabindex="-1"></a>}</span>
<span id="cb59-54"><a href="#cb59-54" tabindex="-1"></a></span>
<span id="cb59-55"><a href="#cb59-55" tabindex="-1"></a><span class="co"># 绘制方程的图像以找到适合的范围</span></span>
<span id="cb59-56"><a href="#cb59-56" tabindex="-1"></a>a_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fu">sqrt</span>(k <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">+</span> <span class="fl">0.01</span>, <span class="fu">sqrt</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fl">0.01</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)  <span class="co"># 限制 a 的上限</span></span>
<span id="cb59-57"><a href="#cb59-57" tabindex="-1"></a>equation_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(a_values, equation, <span class="at">k =</span> k)</span>
<span id="cb59-58"><a href="#cb59-58" tabindex="-1"></a></span>
<span id="cb59-59"><a href="#cb59-59" tabindex="-1"></a><span class="fu">plot</span>(a_values, equation_values, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb59-60"><a href="#cb59-60" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;方程值&quot;</span>, <span class="at">main =</span> <span class="st">&quot;方程的图像&quot;</span>)</span>
<span id="cb59-61"><a href="#cb59-61" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)  <span class="co"># 添加 y=0 的参考线</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># 使用 uniroot 函数来找到 a 的解</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="co"># 请根据图像选择合适的范围</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="co">#a_solution &lt;- uniroot(equation, c(-sqrt(k + 1)+ 0.01, sqrt(k + 1) - 0.01), k = k)  # 你可以根据需要调整范围</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="co">#cat(&quot;a 的解为:&quot;, a_solution$root, &quot;\n&quot;)</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>a_solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(equation, <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>), <span class="at">k =</span> k)  <span class="co"># 你可以根据需要调整范围</span></span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;a 的解为:&quot;</span>, a_solution<span class="sc">$</span>root, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## a 的解为: 0</code></pre>
<p>通过计算可得，a离原点很近，当k很小的时候，求解是精确的，而当k较大时，伽马函数会发生突变，此时需要对伽马函数进行对数转化。</p>
</div>
<div id="思考题" class="section level3">
<h3>思考题</h3>
<p>先通过EM算法：</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co"># 观察数据</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="co"># E-M 算法</span></span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>em_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(Y, <span class="at">max_iter =</span> <span class="dv">100</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  </span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  <span class="co"># 初始化 lambda</span></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(Y[Y <span class="sc">&lt;</span> <span class="dv">1</span>])  <span class="co"># 基于观察数据的初始猜测</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  </span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>    <span class="co"># E 步：计算期望值</span></span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>    <span class="co"># 计算给定 Y_i 的 T_i 的期望值</span></span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>    expected_T <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(Y <span class="sc">&lt;</span> <span class="dv">1</span>, Y, <span class="dv">1</span>)  <span class="co"># 对于 Y_i &lt; 1, T_i = Y_i; 对于 Y_i = 1, T_i 是未知的</span></span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>    expected_T[Y <span class="sc">==</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> lambda)  <span class="co"># E[T | T &gt; 1] = 1 + 1/lambda</span></span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>    </span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>    <span class="co"># M 步：更新 lambda</span></span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>    lambda_new <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(expected_T)</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>    </span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>    <span class="co"># 检查收敛性</span></span>
<span id="cb62-21"><a href="#cb62-21" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(lambda_new <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb62-22"><a href="#cb62-22" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb62-23"><a href="#cb62-23" tabindex="-1"></a>    }</span>
<span id="cb62-24"><a href="#cb62-24" tabindex="-1"></a>    </span>
<span id="cb62-25"><a href="#cb62-25" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> lambda_new</span>
<span id="cb62-26"><a href="#cb62-26" tabindex="-1"></a>  }</span>
<span id="cb62-27"><a href="#cb62-27" tabindex="-1"></a>  </span>
<span id="cb62-28"><a href="#cb62-28" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb62-29"><a href="#cb62-29" tabindex="-1"></a>}</span>
<span id="cb62-30"><a href="#cb62-30" tabindex="-1"></a></span>
<span id="cb62-31"><a href="#cb62-31" tabindex="-1"></a><span class="co"># 运行 E-M 算法</span></span>
<span id="cb62-32"><a href="#cb62-32" tabindex="-1"></a>lambda_estimate <span class="ot">&lt;-</span> <span class="fu">em_algorithm</span>(Y)</span>
<span id="cb62-33"><a href="#cb62-33" tabindex="-1"></a>lambda_estimate</span></code></pre></div>
<pre><code>## [1] 1.037038</code></pre>
<p>使用最大似然估计进行计算:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># 计算 lambda 的 MLE</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">==</span> <span class="dv">1</span>)  <span class="co"># 删失观察值的数量</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">length</span>(Y) <span class="sc">/</span> (<span class="fu">sum</span>(Y[Y <span class="sc">&lt;</span> <span class="dv">1</span>]) <span class="sc">+</span> m <span class="sc">*</span> <span class="dv">1</span>)  <span class="co"># 在 tau = 1 处删失</span></span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>lambda_mle</span></code></pre></div>
<pre><code>## [1] 1.481481</code></pre>
<p>将两者进行比较:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&#39;E-M&#39;</span><span class="ot">=</span>lambda_estimate,<span class="st">&#39;MLE&#39;</span><span class="ot">=</span>lambda_mle)</span></code></pre></div>
<pre><code>##      E-M      MLE 
## 1.037038 1.481481</code></pre>
</div>
</div>
<div id="assignment-9" class="section level2">
<h2>Assignment 9</h2>
<div id="exercise-11.7" class="section level3">
<h3>Exercise 11.7</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>objective_coefficients <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>constraint_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>                              <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), </span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>                            <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a></span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>constraint_rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a>constraint_directions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a></span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a><span class="co"># 解决线性规划问题，默认假设 x, y, z &gt;= 0</span></span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>lp_solution <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, objective_coefficients, </span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>                  constraint_matrix, constraint_directions, </span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a>                  constraint_rhs, <span class="at">compute.sens =</span> <span class="cn">TRUE</span>)</span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a></span>
<span id="cb68-19"><a href="#cb68-19" tabindex="-1"></a>optimal_values <span class="ot">&lt;-</span> lp_solution<span class="sc">$</span>solution</span>
<span id="cb68-20"><a href="#cb68-20" tabindex="-1"></a>optimal_objective <span class="ot">&lt;-</span> lp_solution<span class="sc">$</span>objval</span>
<span id="cb68-21"><a href="#cb68-21" tabindex="-1"></a></span>
<span id="cb68-22"><a href="#cb68-22" tabindex="-1"></a><span class="co"># 创建结果数据框</span></span>
<span id="cb68-23"><a href="#cb68-23" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb68-24"><a href="#cb68-24" tabindex="-1"></a>  <span class="at">Variables =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;z&quot;</span>),</span>
<span id="cb68-25"><a href="#cb68-25" tabindex="-1"></a>  <span class="at">Optimal_Values =</span> optimal_values,</span>
<span id="cb68-26"><a href="#cb68-26" tabindex="-1"></a>  <span class="at">Objective_Value =</span> optimal_objective</span>
<span id="cb68-27"><a href="#cb68-27" tabindex="-1"></a>)</span>
<span id="cb68-28"><a href="#cb68-28" tabindex="-1"></a></span>
<span id="cb68-29"><a href="#cb68-29" tabindex="-1"></a><span class="co"># 打印结果表格</span></span>
<span id="cb68-30"><a href="#cb68-30" tabindex="-1"></a><span class="fu">kable</span>(result_table, <span class="at">caption =</span> <span class="st">&quot;线性规划最优解结果&quot;</span>)</span></code></pre></div>
<table>
<caption>线性规划最优解结果</caption>
<thead>
<tr class="header">
<th align="left">Variables</th>
<th align="right">Optimal_Values</th>
<th align="right">Objective_Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">y</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">z</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
</div>
<div id="exercise-page204.3" class="section level3">
<h3>Exercise page204.3</h3>
<p>LAPPY拟合四个线性回归模型，<code>mtcars</code>数据集中<code>disp</code>（排量）和<code>wt</code>（重量）对<code>mpg</code>（每加仑英里数）的影响，结果显示这些变量对燃油效率的影响显著。</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>model_formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb69-8"><a href="#cb69-8" tabindex="-1"></a>)</span>
<span id="cb69-9"><a href="#cb69-9" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" tabindex="-1"></a><span class="co"># 使用for循环</span></span>
<span id="cb69-11"><a href="#cb69-11" tabindex="-1"></a>model_results_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb69-12"><a href="#cb69-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="fu">seq_along</span>(model_formulas)) {</span>
<span id="cb69-13"><a href="#cb69-13" tabindex="-1"></a>  model <span class="ot">&lt;-</span> <span class="fu">lm</span>(model_formulas[[index]], <span class="at">data =</span> mtcars)</span>
<span id="cb69-14"><a href="#cb69-14" tabindex="-1"></a>  model_results_for[[index]] <span class="ot">&lt;-</span> model</span>
<span id="cb69-15"><a href="#cb69-15" tabindex="-1"></a>}</span>
<span id="cb69-16"><a href="#cb69-16" tabindex="-1"></a></span>
<span id="cb69-17"><a href="#cb69-17" tabindex="-1"></a><span class="co"># 使用lapply</span></span>
<span id="cb69-18"><a href="#cb69-18" tabindex="-1"></a>model_results_apply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_formulas, <span class="cf">function</span>(formula) {</span>
<span id="cb69-19"><a href="#cb69-19" tabindex="-1"></a>  <span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars)</span>
<span id="cb69-20"><a href="#cb69-20" tabindex="-1"></a>})</span>
<span id="cb69-21"><a href="#cb69-21" tabindex="-1"></a></span>
<span id="cb69-22"><a href="#cb69-22" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="fu">seq_along</span>(model_results_apply)) {</span>
<span id="cb69-23"><a href="#cb69-23" tabindex="-1"></a>  model <span class="ot">&lt;-</span> model_results_apply[[index]]</span>
<span id="cb69-24"><a href="#cb69-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Model&quot;</span>, index, <span class="st">&quot;:&quot;</span>)</span>
<span id="cb69-25"><a href="#cb69-25" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Coefficients:&quot;</span>, <span class="fu">coef</span>(model), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb69-26"><a href="#cb69-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;R-squared:&quot;</span>, <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb69-27"><a href="#cb69-27" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;p-value:&quot;</span>, <span class="fu">summary</span>(model)<span class="sc">$</span>fstatistic[<span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)</span>
<span id="cb69-28"><a href="#cb69-28" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Model 1 :Coefficients: 29.59985 -0.04121512 
## R-squared: 0.7183433 
## p-value: 30 
## 
## Model 2 :Coefficients: 10.75202 1557.674 
## R-squared: 0.8596865 
## p-value: 30 
## 
## Model 3 :Coefficients: 34.96055 -0.01772474 -3.350825 
## R-squared: 0.7809306 
## p-value: 29 
## 
## Model 4 :Coefficients: 19.02421 1142.56 -1.797649 
## R-squared: 0.8838038 
## p-value: 29</code></pre>
</div>
<div id="exercise-page204.4" class="section level3">
<h3>Exercise page204.4</h3>
<p>创建fit_linear_model函数来拟合，不用匿名函数,结果如下表格：</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>})</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>fit_linear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>}</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>model_results <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_linear_model)</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a></span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>coefficients_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>  <span class="at">Model =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(model_results),</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>  <span class="at">Intercept =</span> <span class="fu">sapply</span>(model_results, <span class="cf">function</span>(model) <span class="fu">coef</span>(model)[<span class="dv">1</span>]),</span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>  <span class="at">Disp_Coefficient =</span> <span class="fu">sapply</span>(model_results, <span class="cf">function</span>(model) <span class="fu">coef</span>(model)[<span class="dv">2</span>])</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>)</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a></span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a><span class="fu">print</span>(coefficients_df)</span></code></pre></div>
<pre><code>##    Model Intercept Disp_Coefficient
## 1      1  29.69268      -0.04446590
## 2      2  29.72130      -0.04174701
## 3      3  31.71861      -0.04639516
## 4      4  29.70625      -0.04315627
## 5      5  31.95297      -0.04652214
## 6      6  27.69524      -0.03526128
## 7      7  29.25101      -0.03728051
## 8      8  29.65108      -0.04015618
## 9      9  28.34283      -0.03700035
## 10    10  29.18731      -0.03852212</code></pre>
</div>
<div id="exercise-page204.5" class="section level3">
<h3>Exercise page204.5</h3>
<p>对于第一个模型，提取<span class="math inline">\(R^2\)</span>:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="co"># 载入数据</span></span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="co"># 定义模型公式</span></span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>model_formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>)</span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a><span class="co"># 定义提取R²的函数</span></span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) {</span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a>  <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a>}</span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" tabindex="-1"></a><span class="co"># 使用lapply拟合模型并提取R²值</span></span>
<span id="cb73-18"><a href="#cb73-18" tabindex="-1"></a>model_results_apply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(model_formulas, <span class="cf">function</span>(formula) {</span>
<span id="cb73-19"><a href="#cb73-19" tabindex="-1"></a>  <span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars)</span>
<span id="cb73-20"><a href="#cb73-20" tabindex="-1"></a>})</span>
<span id="cb73-21"><a href="#cb73-21" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" tabindex="-1"></a><span class="co"># 创建包含模型和R²值的数据框</span></span>
<span id="cb73-23"><a href="#cb73-23" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb73-24"><a href="#cb73-24" tabindex="-1"></a>  <span class="at">Model =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(model_results_apply),</span>
<span id="cb73-25"><a href="#cb73-25" tabindex="-1"></a>  <span class="at">R_squared =</span> <span class="fu">sapply</span>(model_results_apply, rsq)</span>
<span id="cb73-26"><a href="#cb73-26" tabindex="-1"></a>)</span>
<span id="cb73-27"><a href="#cb73-27" tabindex="-1"></a></span>
<span id="cb73-28"><a href="#cb73-28" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb73-29"><a href="#cb73-29" tabindex="-1"></a><span class="fu">print</span>(results_df)</span></code></pre></div>
<pre><code>##   Model R_squared
## 1     1 0.7183433
## 2     2 0.8596865
## 3     3 0.7809306
## 4     4 0.8838038</code></pre>
<p>对于第二个模型，提取<span class="math inline">\(R^2\)</span>:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a><span class="co">#bootstrap</span></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)  </span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>})</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>fit_linear_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>}</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a></span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>model_results_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>  model_results_for[[i]] <span class="ot">&lt;-</span> <span class="fu">fit_linear_model</span>(bootstraps[[i]])</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>}</span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a></span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a><span class="co"># 使用lapply拟合模型</span></span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a>model_results_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_linear_model)</span>
<span id="cb75-22"><a href="#cb75-22" tabindex="-1"></a></span>
<span id="cb75-23"><a href="#cb75-23" tabindex="-1"></a></span>
<span id="cb75-24"><a href="#cb75-24" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) {</span>
<span id="cb75-25"><a href="#cb75-25" tabindex="-1"></a>  <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span>
<span id="cb75-26"><a href="#cb75-26" tabindex="-1"></a>}</span>
<span id="cb75-27"><a href="#cb75-27" tabindex="-1"></a></span>
<span id="cb75-28"><a href="#cb75-28" tabindex="-1"></a></span>
<span id="cb75-29"><a href="#cb75-29" tabindex="-1"></a>r_squared_for <span class="ot">&lt;-</span> <span class="fu">sapply</span>(model_results_for, rsq)</span>
<span id="cb75-30"><a href="#cb75-30" tabindex="-1"></a>r_squared_lapply <span class="ot">&lt;-</span> <span class="fu">sapply</span>(model_results_lapply, rsq)</span>
<span id="cb75-31"><a href="#cb75-31" tabindex="-1"></a></span>
<span id="cb75-32"><a href="#cb75-32" tabindex="-1"></a></span>
<span id="cb75-33"><a href="#cb75-33" tabindex="-1"></a>results_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb75-34"><a href="#cb75-34" tabindex="-1"></a>  <span class="at">Bootstrap_Sample =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,</span>
<span id="cb75-35"><a href="#cb75-35" tabindex="-1"></a>  <span class="at">R_squared_For =</span> r_squared_for,</span>
<span id="cb75-36"><a href="#cb75-36" tabindex="-1"></a>  <span class="at">R_squared_Lapply =</span> r_squared_lapply</span>
<span id="cb75-37"><a href="#cb75-37" tabindex="-1"></a>)</span>
<span id="cb75-38"><a href="#cb75-38" tabindex="-1"></a></span>
<span id="cb75-39"><a href="#cb75-39" tabindex="-1"></a><span class="fu">print</span>(results_df)</span></code></pre></div>
<pre><code>##    Bootstrap_Sample R_squared_For R_squared_Lapply
## 1                 1     0.7242265        0.7242265
## 2                 2     0.7876236        0.7876236
## 3                 3     0.6816780        0.6816780
## 4                 4     0.7772465        0.7772465
## 5                 5     0.5987460        0.5987460
## 6                 6     0.7087358        0.7087358
## 7                 7     0.6994622        0.6994622
## 8                 8     0.5982239        0.5982239
## 9                 9     0.6540081        0.6540081
## 10               10     0.6629207        0.6629207</code></pre>
</div>
<div id="exercise-page213.3" class="section level3">
<h3>Exercise page213.3</h3>
<p>get rid of the anonymous function by using [[ directly.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>p_values_direct <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="st">`</span><span class="at">[[</span><span class="st">`</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;direct_p_mean&quot;</span><span class="ot">=</span><span class="fu">mean</span>(p_values_direct))</span></code></pre></div>
<pre><code>## direct_p_mean 
##     0.4904223</code></pre>
</div>
<div id="exercise-page214.6" class="section level3">
<h3>Exercise page214.6</h3>
<p>创建一个函数结合map()和vapply(),用于并行，需要使用到FUN、每个FUN的VAPPLY模板:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>parallel_vapply <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., FUN.VALUE) {</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  inputs <span class="ot">&lt;-</span> <span class="fu">list</span>(...)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  <span class="fu">vapply</span>(results, identity, FUN.VALUE)</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="exercise-page365.4" class="section level3">
<h3>Exercise page365.4</h3>
<p>直接使用pearson检验的定义来计算，只计算卡方统计量，代码如下(包含实例)：</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>  </span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  </span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  <span class="co"># 期望频率</span></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(observed)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">colSums</span>(observed)</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_totals, col_totals) <span class="sc">/</span> total</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  </span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>  <span class="co"># 卡方统计量</span></span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>  </span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>}</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a><span class="co"># Example</span></span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>chisq_statistic <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a><span class="fu">print</span>(chisq_statistic)</span></code></pre></div>
<pre><code>## [1] 0.2777778</code></pre>
</div>
<div id="exercise-page365.5" class="section level3">
<h3>Exercise page365.5</h3>
<p>直接构造频数表，并且用于加速chisq算法：</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>fast_count_table <span class="ot">&lt;-</span> <span class="cf">function</span>(vec1, vec2) {</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>  <span class="co"># 确保输入是整数向量</span></span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  <span class="fu">stopifnot</span>(<span class="fu">is.integer</span>(vec1), <span class="fu">is.integer</span>(vec2))</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a>  </span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>  <span class="co"># 找到唯一值并初始化频数矩阵</span></span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  count_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">factor</span>(vec1, <span class="at">levels =</span> <span class="fu">unique</span>(vec1)), </span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>                         <span class="fu">factor</span>(vec2, <span class="at">levels =</span> <span class="fu">unique</span>(vec2)))</span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>  </span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>  <span class="fu">return</span>(count_matrix)</span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a>}</span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a></span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a><span class="co"># 使用快速count_table()加速卡方检验</span></span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a>optimized_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(vec1, vec2) {</span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>  observed_counts <span class="ot">&lt;-</span> <span class="fu">fast_count_table</span>(vec1, vec2)</span>
<span id="cb82-15"><a href="#cb82-15" tabindex="-1"></a>  </span>
<span id="cb82-16"><a href="#cb82-16" tabindex="-1"></a>  <span class="co"># 计算期望频率</span></span>
<span id="cb82-17"><a href="#cb82-17" tabindex="-1"></a>  total_counts <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed_counts)</span>
<span id="cb82-18"><a href="#cb82-18" tabindex="-1"></a>  expected_counts <span class="ot">&lt;-</span> <span class="fu">outer</span>(<span class="fu">rowSums</span>(observed_counts), <span class="fu">colSums</span>(observed_counts)) <span class="sc">/</span> total_counts</span>
<span id="cb82-19"><a href="#cb82-19" tabindex="-1"></a>  </span>
<span id="cb82-20"><a href="#cb82-20" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb82-21"><a href="#cb82-21" tabindex="-1"></a>  chi_square_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed_counts <span class="sc">-</span> expected_counts)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected_counts)</span>
<span id="cb82-22"><a href="#cb82-22" tabindex="-1"></a>  </span>
<span id="cb82-23"><a href="#cb82-23" tabindex="-1"></a>  <span class="fu">return</span>(chi_square_stat)</span>
<span id="cb82-24"><a href="#cb82-24" tabindex="-1"></a>}</span>
<span id="cb82-25"><a href="#cb82-25" tabindex="-1"></a></span>
<span id="cb82-26"><a href="#cb82-26" tabindex="-1"></a><span class="co"># 示例</span></span>
<span id="cb82-27"><a href="#cb82-27" tabindex="-1"></a>vector_a <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb82-28"><a href="#cb82-28" tabindex="-1"></a>vector_b <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb82-29"><a href="#cb82-29" tabindex="-1"></a>chi_square_result <span class="ot">&lt;-</span> <span class="fu">optimized_chisq_test</span>(vector_a, vector_b)</span>
<span id="cb82-30"><a href="#cb82-30" tabindex="-1"></a><span class="fu">print</span>(chi_square_result)</span></code></pre></div>
<pre><code>## [1] 0.6666667</code></pre>
</div>
</div>
<div id="assignment-10" class="section level2">
<h2>Assignment 10</h2>
<div id="exercise-9.8-by-rcpp" class="section level3">
<h3>Exercise 9.8 by Rcpp</h3>
<p>写的Rcpp函数如下：</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp<span class="op">;</span></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>List gibbs_sampler<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">int</span> num_samples<span class="op">,</span> <span class="dt">int</span> burn_in<span class="op">)</span> <span class="op">{</span></span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>  <span class="co">// Initialize vectors to store samples</span></span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>  NumericVector x_samples<span class="op">(</span>num_samples<span class="op">);</span></span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a>  NumericVector y_samples<span class="op">(</span>num_samples<span class="op">);</span></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>  </span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>  <span class="co">// Initial values</span></span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>  <span class="dt">double</span> x <span class="op">=</span> R<span class="op">::</span>rbeta<span class="op">(</span>a<span class="op">,</span> b<span class="op">)</span> <span class="op">*</span> n<span class="op">;</span> <span class="co">// Initial x value</span></span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>  <span class="dt">int</span> y <span class="op">=</span> R<span class="op">::</span>rbinom<span class="op">(</span>n<span class="op">,</span> x <span class="op">/</span> n<span class="op">);</span>   <span class="co">// Initial y value</span></span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>  </span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>  <span class="co">// Main Gibbs sampling loop</span></span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> num_samples <span class="op">+</span> burn_in<span class="op">;</span> <span class="op">++</span>i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>    <span class="co">// Sample y | x from Binomial(n, x / n)</span></span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>    y <span class="op">=</span> R<span class="op">::</span>rbinom<span class="op">(</span>n<span class="op">,</span> x <span class="op">/</span> n<span class="op">);</span></span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>    </span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a>    <span class="co">// Sample x | y from Beta(y + a, n - y + b)</span></span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a>    x <span class="op">=</span> R<span class="op">::</span>rbeta<span class="op">(</span>y <span class="op">+</span> a<span class="op">,</span> n <span class="op">-</span> y <span class="op">+</span> b<span class="op">)</span> <span class="op">*</span> n<span class="op">;</span></span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a>    </span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>    <span class="co">// Store samples after burn-in period</span></span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>i <span class="op">&gt;=</span> burn_in<span class="op">)</span> <span class="op">{</span></span>
<span id="cb84-24"><a href="#cb84-24" tabindex="-1"></a>      x_samples<span class="op">[</span>i <span class="op">-</span> burn_in<span class="op">]</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb84-25"><a href="#cb84-25" tabindex="-1"></a>      y_samples<span class="op">[</span>i <span class="op">-</span> burn_in<span class="op">]</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb84-26"><a href="#cb84-26" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb84-27"><a href="#cb84-27" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb84-28"><a href="#cb84-28" tabindex="-1"></a>  </span>
<span id="cb84-29"><a href="#cb84-29" tabindex="-1"></a>  <span class="co">// Return samples as a list</span></span>
<span id="cb84-30"><a href="#cb84-30" tabindex="-1"></a>  <span class="cf">return</span> List<span class="op">::</span>create<span class="op">(</span>Named<span class="op">(</span><span class="st">&quot;x_samples&quot;</span><span class="op">)</span> <span class="op">=</span> x_samples<span class="op">,</span></span>
<span id="cb84-31"><a href="#cb84-31" tabindex="-1"></a>                      Named<span class="op">(</span><span class="st">&quot;y_samples&quot;</span><span class="op">)</span> <span class="op">=</span> y_samples<span class="op">);</span></span>
<span id="cb84-32"><a href="#cb84-32" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>与</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>      <span class="co"># Binomial的试验次数</span></span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>       <span class="co"># Beta分布的参数</span></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span>       <span class="co"># Beta分布的参数</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">5000</span>  <span class="co"># 样本数量</span></span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>      <span class="co"># Burn-in阶段的样本数量</span></span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="co"># 运行Gibbs采样</span></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in)</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a><span class="co"># 转换为数据框</span></span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> samples<span class="sc">$</span>x_samples, <span class="at">y =</span> samples<span class="sc">$</span>y_samples)</span>
<span id="cb85-15"><a href="#cb85-15" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" tabindex="-1"></a><span class="co"># 绘制二维分布的散点图</span></span>
<span id="cb85-17"><a href="#cb85-17" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb85-18"><a href="#cb85-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb85-19"><a href="#cb85-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb85-20"><a href="#cb85-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;二维分布散点图&quot;</span>,</span>
<span id="cb85-21"><a href="#cb85-21" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;x (Binomial Samples)&quot;</span>,</span>
<span id="cb85-22"><a href="#cb85-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;y (Beta Samples)&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABBVBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQkGaQtpCQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+vxpaX1dHT4UVH6OTn7KCj8HBz9FBT+AQH+AwP+BAT+BQX+Bwf+Cgr+Dg7/AQH/AgL/AwP/BAT/Bgb/CAj/Cwv/Dw//Fhb/Hx//LCz/Pj7/WFj/fn7/s7P/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T///8IHK0DAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQ0UlEQVR4nO2di2LbthWG2dZukq7L5nVtt7hbu7VaU62tLctSYssSRYIgCMKOl5ve/1EGgPcreJNEieePY0uCABCfgHMggAC0DahU2r4voO8CQAoBIIUAkEIASCEApFAXgDTvVzoprfiZFkbq+FK6V4eA4mlpmaTrAdLi6uASm6uD3LWchKoUv/QdsRcODVDmo5XVIfNSlLamZepDWIPiFST1hoMFlJeClmxTWupvJh8taoRa7ltkiI/rwAF5pUg0mJwyJ8oZVpVSQFoW4T7UjZEOm1g6yVgryckpejnbbLXQMR48oLAUoeWJFTYyNbHyhxVIi0VKXI+W+b0vdWODMnUk8dHH2pKWDNWSQDYJQOmWux91Y4MSTSxMNu7lkoCi+lUEKF7Z2l5iK+2iBmUBZd6S03XwzfTB16BYOmmHVAwo16DnXNYBGumcXt+myGNnAGnpGhRvYvGWGNigRpfYrbqwQf6fGLF02qkuTb6RzrNVnVxiK3VpgxKvZL7dJy2UluWReCFTTfelLm1Q8mE65dQ74l0gLfO+DO+9ab+5H4AAkEIASCEApBAAUggAKQSAFAJACgEghRoDumga2DjiXgIBEABqFwiAAFC7QAAEgNoFlgF6+5dnz15sNu+/ffbl7x3m2TsGTQG9/9tPm7df/fTxhxeb3/7YYZ69YxALZIylQ4sBvRFUXr54//dfNm//+kt3F9RjQOz+/j5NqNwG8Vr09uvfZWXyEztqTS4vLyf+40qAPv7wzebNl3FAtT+UemEHVoPef/sNN9VfDwdQPRvEvRj3YZsh2aA8FQPy+MhmNhgvlqNiQL89E3oB/aCGAkAK9RtQytpWiJljn6WOE1DaX6tj5nl4KQAEgCrFHBggsEE7CwRAAKhdIAACQO0CjxNQ4JEYpUw+uQheZFI1kj1KQEGfhrmMuVQ8ufBf5L9cN93hAUAAKBUIgFSBYIN2FwiAOga012mrnaohoBiqpoG9qySDaGKMTYIHlP+T5phyEUyESb4ILXNopSNbPQRA3H1fMu+ByxzmCofucj7Ypo7DAybBcFjo52MDZAAIAAEgZSDYoH0FAiAA1C4QAAGgdoH9BuR7msDhXISvxgKks6KUTWIjGZQQ/pBQQjGhTAZyh0aZNwCSHu84XEB+XyXsslwEr/qDXiKAuowXnVL3yg3Hwvgz13YdlziIOsRmzLlyKXGpGD/jT9IjZgAIAO0M0NjbTORpaYza5WwesV826N3zgMxY++T70kjKZI/Ri73788/Rq4knHefZOwaHa4P6EAiAagF69/yMW6JPw+Yl77AX90v/Ae60lxqdbMaf/jw+8Z++kWBevug2z0xY3KtcFAXEA7mDwgam3J1jgpFhyCGfKUEYIQNj4fWZnDL0Jg5lzGg8yPNmlUuSAMQr0Ifzk82DX4VefvEjr0Ef/5VdyKJMtg6gxO2TF0UBsUB279iIcDaMEAutEbYctqFT2zbMNQeHHcIcR3Z55I+IEo0o8t4QdZt+1ZAt7GkIyGti77+VCxKCxLpXfJFWpYDJ5fV8MVvOlpPZ7G7xerG8u55cTKfz+c3t6+XNcnk9m1xfTyZX/k8iqcnVlP/LzS6lPEAfzp8+8B7QKGhiEtDbr37KrUVDrEGbx1PtZDP67NfgebgMKscODdEGZbQbQL0OVAMSSzI//hvcvCf+bfVsnGpivB/0RY4jGySg0Wf/9Tx9BQ0RkHTzZzE3v5U8K0YM7w7zHmBM2ISbZIK5KcY6/08MbpMN3bPTmEyxsdKxMMKYG2pvapAGd5pNaJCQ9zxh/Q8TUHh/oRzmojaltn1tY4d7ddPUTdM0TGSuV4al878clbVAK9NEiL+VsyQuk7PQrnev4v0Vf0RDp5/qP9QZMBNNTPQVK2iQgDYPlQcUBwqohoZog2ppcF7s3fNwB/A+GOm+BEINAkDtArNfNfiXjdIIrfPsHYM6/SBhfXbWD4p8SXRf3MR3NmIukHsqhsW4D3fbUjMifRjC0nNxP4bQijswpBsrhKaUEvGinGeV04OUEDHuISYQJzQ1clK5JOmetPizo5501BuJ3Vl56XVXCGPEcGy85r0ak2DLlprbFkamaRnYMky85g9X1krX17w7tLIXhFgmNhF2xIwqc1yXiMlnl9kuced+j6h+SQBQrSYmBlx31sQOEFCtrtAQbVAtDdKL1dEgAT2eqtpX8+mvQ1MeoIqDrRW4H2kN8t18NdXMM7k0Ilx1y7zZK7G+QiyswEsqjCrlppibV25zCRVzXYaww/rqhnsrYyWky988mGDvkYGW/DERU2KU2/DYfWTiTjPKLXjDkqRq0NYAJRfXhOu25VJtl7NxmEOJjfEMU9vlUBzHdLCFLdOwTbRCqzVnor/SfTKBLO7o1x4hc2FZxLYJs7kfs0h4JyK7d1xKZhx3s5Kk+kGVuogVkj1WQGojXTHZIwX04bzacLQ62SO1Qds00h1E3L8X26KR7iLi/gFtHp9sy0h3EXH/gIIvqzBoHxN8F+sZIMamoeci0rcwMZ6BuF/SCUILbAjvxL0VQnGHjih/w6uEj18RJG4n406O/0JkyZ+IpRleJiy+ziNcEt2gJLvqBwVi9+7E9fs+vMPDeyfMcQhei37OemVad6vVWhdu2+/fRFpnAK1sRJBpcUSWba8XhAOjjmAuVwFFK4VosKi+SUnS/SDuyCo6+yECEmhGTzcP0S1mTZM9YkDjk+0O2h+2DRpJOuMt1qA2EXvgxcSXsVGV1XRt8uwdg365+R4yAEBdARrztiW+bURjHvI+aThXw5eYVhXD9tHMqlwv1tn5YsxbRLGZMO60KMFiko8ybERuych68oRerZARjJh5f3VEZMo8xSX2Nw7apPcHanKxkUJAcrTs8fRM3OvqeTFvvVhXZ/uIdTaEuvf00qaWgyyDmIhQE6cZlALKyLIJT5mnYy0JlltP+cOVyRs1uwAkO9Bycj65Xqyr88XESq3Z9Opyejmf3l0v7m5mt4vZ9Hb5qpXu5jOeMk/nbjlbXk+uLif+2rDCVWiN58UkIFl5koC6Ol/s4GuQGE70Zg6jBWPZGlQx2WO0QaL2SBP0EN2D97ZDG9Q+4r69GO9Dcw//4TzWkRZg4HyxEkE/CHrSqsDdAAo2A6cEETLlxlQMZejpedIqXkzHujTUPB3CiJxZZExugjOVN5Wx/FvJeg4o2E7eIbZj2TNmozIGpYBWK5v/N/mP41iWhU2LOg4R2yhNxG2J3jalrS42LQAEgOpdbFo7mdU4Fhu0g1mNNhH378V2MKvRJmI/AG17VqOHDGrYIJjVyApmNfbg5r2JOkppsPCYiHXIhGDk+aKs86rsxYwVwgjr2BDLnom/Ljo8vqfJxda1QZv2y6G8HfiF1yXe0nXiUIJth3d/jEpdnbJAY62bhrVCawtZDvXOfmL+AVANGQCgrgbMwrVQLXd/OVZA3d3lerQ2qJaG6cVSO1DlJDYY5QKCHaiy6usGS30J3BogebAOYRsiPE9olnVdL7fDN/kGXBcbJOIZ/28YOgkHNQp3YKx5sWXa0g5UVGwG6boOXoup08T9hs3cvFjQfIewoRv2mvjDYoV7eNa82NJybmkHqmMFVEMASKEB2iAx9SxGpastfR6eFxt99uuHc+2s6rrDwQGSq+mkh4cx6bhSd5hJQNBRjAkA7RSQXL9MKJ0QUt+T5wQKn4bETCHC3HPN5GJmfzOdaNtIz5kdBCAxy2mLWxHnzsrIBVATkMdIXxlrbDH7ilJHLt5x3XvXCTYe9btDOwDUfqPJowZUVwBIoeHZIDg+K1eJA9j8MXs4gC2m5JBrz47w60FgBRsEx2cpVPX4LHl/l9jmUGGIlUZapwTpiFJxKA0R63UpIVis/50Ec2C1i7lNQFWPzxJbyDsY22sVhApezDRtyzBshEzLtG0LOTYhHP9lMItau5jbBFT1+KzJ5dXkermcv263vknq9nZ+d3MzXyxu727n87vF9Xw2m0zlCqfWy5xazYvlqerxWYOtQVJVTocagA1697yo/wPHZ/niHaH0cCIcn5VUcl24EByflZJAVGHAY6iAxnLaZ6Qetx8koA/n/qERFQYVL2IbiYu9v/0tH705wppezCDyYB6M9YUhtolk0fY5sZ1uPC/WPYM6XqzWXq7hVvSUug6y9XII5WGGbpgrw7BeIQPb8qRPbwMmEu2VtJH9oC0w2NqAGQAqFQBSaIg2qJYG6cXqCAApBIAUAkAKASCFLvxjKMUEHk7fOFfJi4WLww3uApE8s4fO5LaTBd7q0LyYPMhUTAGbmWnmam7ex6rruo0sc21xQleWTYjt5PZ3Dq4fBIBKBYAUAhukEHix/MQGo4aAYqiaBvaukkAT2xMgsS2Nv61hZoGFwkjL98udbRhGYv9DZCBv78Ngu/JdTp5uCdDk3sWoaKekSl7MIq5rEQdjB1nEtlhsw/vg9sOuigmAAFC7YoIN6iOgpoG9c1QACABtMRAAAaB2gS3cPDUK16vkrUlBxECGOBh9Kccz5MygSIfF76sTx6k3LEnfALErhHPIlLl5vEbIsuwlIo7tupyPG6x9j85dvSwZEgNAAGhIgMAGqQReTCEApBAACgTHRpSr6Pis8iUX+mpF2AYbBsXIEBvl0HC78N4xaAmo4Oga1ZoU01g7Yi/IFbKJgR2XOMGG871j0BJQwfFZyiVfN6+vF8vZ7NViPrtZXl/Nrq8m3vFWB6LKgAqOz4IaFKjo+CywQb7g+CyF4PgslaAf1EwASCEApBAAUggAgaQAkEIASCEApBAAUggAKQSAFAJACgEghZoBKviGr1bBlnpqlZ3LXSFm43ybASqa6VCrYEs9pd6I4jXKVsZsnG9DQEWjjEoVbamn0ssvfuTZNcnWi9k0301DQEXj1Eolt9SrlSUvZrNsRczm+TYDVDDToVbRlnoVYvJiNstWom2c745rkFQje9CuBjXPd8c2SKoxoGbZ7gNQ0UyHUkVb6qklitks26BxNst3D/2gvC311GrfD2qWL/SkVQJACgEghQCQQgBIIQCk0A4BfTg/E1t9anK3z8fPy0+miIWHD8Vx3coDLXISfvcn9SkYhdohoPGJf/rdg1bj0O2oyGN5MpMqbh75akfK5Wt3gMTn6AGqeEhgIL/I8gg99T68eYD8qI20XUBj3iKCg23FIdsRIF6Ox8//cSqbm2h4J6Jo4rk8h/JMllM80p5GgEKsYUAiwndyt3DxbpGgqG7yfYJNiyq05Ro0OhE/QrJ8fhPzyvF4yv/ydiNO3xb/veea9yIPlyeeeQ9lCg/BVuBhQCLCqZcSf7c8zpt/HjLi42kFi1eiLQPiH/ITb4dhWSrfSPNPVwLyLj049c177r/If/736yZ46KcmrDQvexiQiBBFlAny/B6fBJsby8ybads2aBwYVR/QU/lQfrreB8zLI+p/7Hn05EG6rcTHL+ImAhIRBJXPvx8HRxSNgkNja1q9uLYNaBScaxsDJKuLGpA8pCFRg4TSAXmAIovz7rk0Rv0F9PDpf/zaXQJI9G0efFsTK68E9xDWoOhPIiCMIJvYk5+DBAPJfHvbxOLH149CIx16Ma9ooZFOAxL15DRqYiNRbvHGREAEKGakOUH+Jplz9KZm2i6gkXTtXiN7kI+DA8ziLSR086kWw03IJ/+UjcZLbRwcfhYPiCJ8F6YiEvwktGEbr4vRULvtKG5RZZWkvx3FhMbVjiFvqDJAh/FVo9XnqFYJoEP5snqYAkAKASCFAJBCAEghAKQQAFLo/36kVWJeoCiUAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="exercise-9.8-by-r" class="section level3">
<h3>Exercise 9.8 by R</h3>
<p>之前写的</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span>      <span class="co"># Binomial的试验次数</span></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>       <span class="co"># Beta分布的参数</span></span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span>       <span class="co"># Beta分布的参数</span></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">5000</span>  <span class="co"># 样本数量</span></span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>      <span class="co"># Burn-in阶段的样本数量</span></span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a><span class="co"># 初始化</span></span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a><span class="co">#x_samples[1] &lt;- rbeta(1, a, b) * n  # 初始x值</span></span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> n<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="fl">0.5</span></span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a><span class="co">#y_samples[1] &lt;- rbinom(1, n, x_samples[1] / n)  # 初始y值</span></span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a><span class="co"># 吉布斯采样</span></span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>  <span class="co"># 从条件二项分布中采样y</span></span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>  y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x_samples[i<span class="dv">-1</span>] <span class="sc">/</span> n)</span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a>  </span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>  <span class="co"># 从条件Beta分布中采样x</span></span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>  x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, y_samples[i] <span class="sc">+</span> a, n <span class="sc">-</span> y_samples[i] <span class="sc">+</span> b) <span class="sc">*</span> n</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a>}</span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a></span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a><span class="co"># 丢弃烧入期样本</span></span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a>x_samples <span class="ot">&lt;-</span> x_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb86-30"><a href="#cb86-30" tabindex="-1"></a>y_samples <span class="ot">&lt;-</span> y_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb86-31"><a href="#cb86-31" tabindex="-1"></a></span>
<span id="cb86-32"><a href="#cb86-32" tabindex="-1"></a><span class="co"># 绘制样本的散点图</span></span>
<span id="cb86-33"><a href="#cb86-33" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_samples, <span class="at">y =</span> y_samples)</span>
<span id="cb86-34"><a href="#cb86-34" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb86-35"><a href="#cb86-35" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb86-36"><a href="#cb86-36" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gibbs Sampling of Bivariate Distribution&quot;</span>,</span>
<span id="cb86-37"><a href="#cb86-37" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;x&quot;</span>, <span class="at">y =</span> <span class="st">&quot;y&quot;</span>) <span class="sc">+</span></span>
<span id="cb86-38"><a href="#cb86-38" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>现在开始用qqplot函数进行比较：</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># 从Rcpp函数获取样本</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>samples_rcpp <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in)</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a><span class="co"># 提取Rcpp生成的样本</span></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>x_samples_rcpp <span class="ot">&lt;-</span> samples_rcpp<span class="sc">$</span>x_samples</span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>y_samples_rcpp <span class="ot">&lt;-</span> samples_rcpp<span class="sc">$</span>y_samples</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a><span class="co"># 比较x_samples</span></span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a><span class="fu">qqplot</span>(x_samples_rcpp, x_samples, <span class="at">main =</span> <span class="st">&quot;QQ Plot of x_samples&quot;</span>,</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Rcpp x_samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R x_samples&quot;</span>)</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># 比较y_samples</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a><span class="fu">qqplot</span>(y_samples_rcpp, y_samples, <span class="at">main =</span> <span class="st">&quot;QQ Plot of y_samples&quot;</span>,</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Rcpp y_samples&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R y_samples&quot;</span>)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看到，x的基本重叠在一条线上，而y有较大偏差</p>
</div>
<div id="计算时间比较" class="section level3">
<h3>计算时间比较:</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a><span class="co"># Source the Rcpp code</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a><span class="co">#sourceCpp(&quot;path_to_your_rcpp_file.cpp&quot;)  # Replace with the actual path to your Rcpp file</span></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a><span class="co"># Define the R function for Gibbs sampling</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>gibbs_sampler_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b, num_samples, burn_in) {</span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb89-11"><a href="#cb89-11" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb89-12"><a href="#cb89-12" tabindex="-1"></a>  x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb89-13"><a href="#cb89-13" tabindex="-1"></a>  y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb89-14"><a href="#cb89-14" tabindex="-1"></a>  </span>
<span id="cb89-15"><a href="#cb89-15" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb89-16"><a href="#cb89-16" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, x_samples[i<span class="dv">-1</span>] <span class="sc">/</span> n)</span>
<span id="cb89-17"><a href="#cb89-17" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, y_samples[i] <span class="sc">+</span> a, n <span class="sc">-</span> y_samples[i] <span class="sc">+</span> b) <span class="sc">*</span> n</span>
<span id="cb89-18"><a href="#cb89-18" tabindex="-1"></a>  }</span>
<span id="cb89-19"><a href="#cb89-19" tabindex="-1"></a>  </span>
<span id="cb89-20"><a href="#cb89-20" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> x_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb89-21"><a href="#cb89-21" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> y_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb89-22"><a href="#cb89-22" tabindex="-1"></a>  </span>
<span id="cb89-23"><a href="#cb89-23" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">x_samples =</span> x_samples, <span class="at">y_samples =</span> y_samples)</span>
<span id="cb89-24"><a href="#cb89-24" tabindex="-1"></a>}</span>
<span id="cb89-25"><a href="#cb89-25" tabindex="-1"></a></span>
<span id="cb89-26"><a href="#cb89-26" tabindex="-1"></a><span class="co"># Set parameters</span></span>
<span id="cb89-27"><a href="#cb89-27" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb89-28"><a href="#cb89-28" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb89-29"><a href="#cb89-29" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb89-30"><a href="#cb89-30" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb89-31"><a href="#cb89-31" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb89-32"><a href="#cb89-32" tabindex="-1"></a></span>
<span id="cb89-33"><a href="#cb89-33" tabindex="-1"></a><span class="co"># Run microbenchmark</span></span>
<span id="cb89-34"><a href="#cb89-34" tabindex="-1"></a>benchmark_results <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb89-35"><a href="#cb89-35" tabindex="-1"></a>  <span class="at">Rcpp =</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in),</span>
<span id="cb89-36"><a href="#cb89-36" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">gibbs_sampler_r</span>(n, a, b, num_samples, burn_in),</span>
<span id="cb89-37"><a href="#cb89-37" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span></span>
<span id="cb89-38"><a href="#cb89-38" tabindex="-1"></a>)</span>
<span id="cb89-39"><a href="#cb89-39" tabindex="-1"></a></span>
<span id="cb89-40"><a href="#cb89-40" tabindex="-1"></a><span class="co"># Print benchmark results</span></span>
<span id="cb89-41"><a href="#cb89-41" tabindex="-1"></a><span class="fu">print</span>(benchmark_results)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##  expr    min     lq    mean median     uq     max neval
##  Rcpp 1.0297 1.0468 1.07625 1.0872 1.0945  1.1144    10
##     R 6.5706 6.8682 8.30366 7.3249 9.3255 13.7192    10</code></pre>
</div>
<div id="comments" class="section level3">
<h3>Comments:</h3>
<ol style="list-style-type: decimal">
<li><p>Rcpp的代码在所有统计指标上都表现出更快的执行速度。最小、中位数和最大时间都显著低于R语言实现，表明Rcpp在速度上具有明显优势。
稳定性：</p></li>
<li><p>Rcpp的运行时间分布较为集中，最大时间与最小时间的差距较小，表明其在多次运行中的性能较为稳定。
R语言的运行时间在最大值和最小值之间的差距较大，显示出更大的波动性，特别是在最大时间上，R语言的实现显著慢于Rcpp。</p></li>
</ol>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
